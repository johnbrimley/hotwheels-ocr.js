(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();let j;function Vc(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`)}function Hc(e,t){return e=e>>>0,Xc().subarray(e/4,e/4+t)}let Nn=null;function Xc(){return(Nn===null||Nn.byteLength===0)&&(Nn=new Float32Array(j.memory.buffer)),Nn}function $c(e,t){return e=e>>>0,Yc(e,t)}let Ln=null;function Ba(){return(Ln===null||Ln.byteLength===0)&&(Ln=new Uint8Array(j.memory.buffer)),Ln}function bo(e,t){const n=t(e.length*1,1)>>>0;return Ba().set(e,n/1),ur=e.length,n}let ar=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});ar.decode();const qc=2146435072;let xo=0;function Yc(e,t){return xo+=t,xo>=qc&&(ar=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),ar.decode(),xo=t),ar.decode(Ba().subarray(e,e+t))}let ur=0;const Vi=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>j.__wbg_structurepasssettings_free(e>>>0,1));let mr=class{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Vi.unregister(this),t}free(){const t=this.__destroy_into_raw();j.__wbg_structurepasssettings_free(t,0)}get continuity_threshold(){return j.__wbg_get_structurepasssettings_continuity_threshold(this.__wbg_ptr)}set continuity_threshold(t){j.__wbg_set_structurepasssettings_continuity_threshold(this.__wbg_ptr,t)}get magnitude_threshold(){return j.__wbg_get_structurepasssettings_magnitude_threshold(this.__wbg_ptr)}set magnitude_threshold(t){j.__wbg_set_structurepasssettings_magnitude_threshold(this.__wbg_ptr,t)}constructor(t,n){const r=j.structurepasssettings_new(t,n);return this.__wbg_ptr=r>>>0,Vi.register(this,this.__wbg_ptr,this),this}};Symbol.dispose&&(mr.prototype[Symbol.dispose]=mr.prototype.free);function Kc(e,t,n,r){Vc(e,mr);var o=e.__destroy_into_raw();const i=bo(t,j.__wbindgen_malloc),a=ur,s=bo(n,j.__wbindgen_malloc),u=ur,c=bo(r,j.__wbindgen_malloc),l=ur,d=j.draw(o,i,a,s,u,c,l);var f=Hc(d[0],d[1]).slice();return j.__wbindgen_free(d[0],d[1]*4,4),f}const Wc=new Set(["basic","cors","default"]);async function jc(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(r){if(e.ok&&Wc.has(e.type)&&e.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function Qc(){const e={};return e.wbg={},e.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(t,n){throw new Error($c(t,n))},e.wbg.__wbindgen_init_externref_table=function(){const t=j.__wbindgen_externrefs,n=t.grow(4);t.set(0,void 0),t.set(n+0,void 0),t.set(n+1,null),t.set(n+2,!0),t.set(n+3,!1)},e}function Zc(e,t){return j=e.exports,Ca.__wbindgen_wasm_module=t,Nn=null,Ln=null,j.__wbindgen_start(),j}async function Ca(e){if(j!==void 0)return j;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof e>"u"&&(e=new URL("/hotwheels-ocr-webgl.js/assets/hotwheels-ocr-wasm_bg-D0_d1MAa.wasm",import.meta.url));const t=Qc();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await jc(await e,t);return Zc(n,r)}const Fo=!1;var Sr=Array.isArray,Jc=Array.prototype.indexOf,Tr=Array.from,el=Object.defineProperty,wt=Object.getOwnPropertyDescriptor,Ia=Object.getOwnPropertyDescriptors,tl=Object.prototype,nl=Array.prototype,$o=Object.getPrototypeOf,Hi=Object.isExtensible;function rl(e){return typeof e=="function"}const In=()=>{};function ol(e){return e()}function wo(e){for(var t=0;t<e.length;t++)e[t]()}function Da(){var e,t,n=new Promise((r,o)=>{e=r,t=o});return{promise:n,resolve:e,reject:t}}const se=2,qo=4,Ar=8,il=1<<24,ze=16,nt=32,Nt=64,Fr=128,Ae=512,oe=1024,me=2048,Fe=4096,xe=8192,Qe=16384,wr=32768,ht=65536,Xi=1<<17,Ma=1<<18,vn=1<<19,ka=1<<20,je=1<<25,It=32768,Po=1<<21,Yo=1<<22,ct=1<<23,Ze=Symbol("$state"),sl=Symbol("legacy props"),al=Symbol(""),sn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ko(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ul(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function cl(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ll(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function fl(e){throw new Error("https://svelte.dev/e/effect_orphan")}function dl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function hl(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function ml(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function _l(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function vl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function pl(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const bl=1,xl=2,Na=4,gl=8,yl=16,El=1,Rl=2,Sl=4,Tl=8,Al=16,Fl=4,wl=2,ue=Symbol(),Pl="http://www.w3.org/1999/xhtml";function Bl(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Cl(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function La(e){return e===this.v}function Il(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ga(e){return!Il(e,this.v)}let pn=!1,Dl=!1;function Ml(){pn=!0}let q=null;function dn(e){q=e}function _e(e,t=!1,n){q={p:q,i:!1,c:null,e:null,s:e,x:null,l:pn&&!t?{s:null,u:null,$:[]}:null}}function ve(e){var t=q,n=t.e;if(n!==null){t.e=null;for(var r of n)Qa(r)}return e!==void 0&&(t.x=e),t.i=!0,q=t.p,e??{}}function Kn(){return!pn||q!==null&&q.l===null}let an=[];function kl(){var e=an;an=[],wo(e)}function Lt(e){if(an.length===0){var t=an;queueMicrotask(()=>{t===an&&kl()})}an.push(e)}function Ua(e){var t=O;if(t===null)return G.f|=ct,e;if((t.f&wr)===0){if((t.f&Fr)===0)throw e;t.b.error(e)}else hn(e,t)}function hn(e,t){for(;t!==null;){if((t.f&Fr)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e}const Jn=new Set;let H=null,cr=null,Re=null,Me=[],Wo=null,Bo=!1;class ke{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#u=null;#i=new Set;#o=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(t){Me=[],cr=null,this.apply();var n={parent:null,effect:null,effects:[],render_effects:[]};for(const r of t)this.#s(r,n);this.is_fork||this.#l(),this.is_deferred()?(this.#a(n.effects),this.#a(n.render_effects)):(cr=this,H=null,$i(n.render_effects),$i(n.effects),cr=null,this.#u?.resolve()),Re=null}#s(t,n){t.f^=oe;for(var r=t.first;r!==null;){var o=r.f,i=(o&(nt|Nt))!==0,a=i&&(o&oe)!==0,s=a||(o&xe)!==0||this.skipped_effects.has(r);if((r.f&Fr)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[]}),!s&&r.fn!==null){i?r.f^=oe:(o&qo)!==0?n.effects.push(r):xn(r)&&((r.f&ze)!==0&&this.#i.add(r),mn(r));var u=r.first;if(u!==null){r=u;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)c===n.effect&&(this.#a(n.effects),this.#a(n.render_effects),n=n.parent),r=c.next,c=c.parent}}#a(t){for(const n of t)(n.f&me)!==0?this.#i.add(n):(n.f&Fe)!==0&&this.#o.add(n),this.#c(n.deps),ie(n,oe)}#c(t){if(t!==null)for(const n of t)(n.f&se)===0||(n.f&It)===0||(n.f^=It,this.#c(n.deps))}capture(t,n){this.previous.has(t)||this.previous.set(t,n),(t.f&ct)===0&&(this.current.set(t,t.v),Re?.set(t,t.v))}activate(){H=this,this.apply()}deactivate(){H===this&&(H=null,Re=null)}flush(){if(this.activate(),Me.length>0){if(Nl(),H!==null&&H!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#l(){if(this.#n===0){for(const t of this.#e)t();this.#e.clear()}this.#r===0&&this.#f()}#f(){if(Jn.size>1){this.previous.clear();var t=Re,n=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Jn){if(i===this){n=!1;continue}const a=[];for(const[u,c]of this.current){if(i.current.has(u))if(n&&c!==i.current.get(u))i.current.set(u,c);else continue;a.push(u)}if(a.length===0)continue;const s=[...i.current.keys()].filter(u=>!this.current.has(u));if(s.length>0){var o=Me;Me=[];const u=new Set,c=new Map;for(const l of a)Oa(l,s,u,c);if(Me.length>0){H=i,i.apply();for(const l of Me)i.#s(l,r);i.deactivate()}Me=o}}H=null,Re=t}this.committed=!0,Jn.delete(this)}increment(t){this.#r+=1,t&&(this.#n+=1)}decrement(t){this.#r-=1,t&&(this.#n-=1),this.revive()}revive(){for(const t of this.#i)this.#o.delete(t),ie(t,me),Dt(t);for(const t of this.#o)ie(t,Fe),Dt(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#u??=Da()).promise}static ensure(){if(H===null){const t=H=new ke;Jn.add(H),ke.enqueue(()=>{H===t&&t.flush()})}return H}static enqueue(t){Lt(t)}apply(){}}function Nl(){var e=Bt;Bo=!0;var t=null;try{var n=0;for(vr(!0);Me.length>0;){var r=ke.ensure();if(n++>1e3){var o,i;Ll()}r.process(Me),lt.clear()}}finally{Bo=!1,vr(e),Wo=null}}function Ll(){try{dl()}catch(e){hn(e,Wo)}}let Ke=null;function $i(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(Qe|xe))===0&&xn(r)&&(Ke=new Set,mn(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?eu(r):r.fn=null),Ke?.size>0)){lt.clear();for(const o of Ke){if((o.f&(Qe|xe))!==0)continue;const i=[o];let a=o.parent;for(;a!==null;)Ke.has(a)&&(Ke.delete(a),i.push(a)),a=a.parent;for(let s=i.length-1;s>=0;s--){const u=i[s];(u.f&(Qe|xe))===0&&mn(u)}}Ke.clear()}}Ke=null}}function Oa(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const o of e.reactions){const i=o.f;(i&se)!==0?Oa(o,t,n,r):(i&(Yo|ze))!==0&&(i&me)===0&&za(o,t,r)&&(ie(o,me),Dt(o))}}function za(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const o of e.deps){if(t.includes(o))return!0;if((o.f&se)!==0&&za(o,t,n))return n.set(o,!0),!0}return n.set(e,!1),!1}function Dt(e){for(var t=Wo=e;t.parent!==null;){t=t.parent;var n=t.f;if(Bo&&t===O&&(n&ze)!==0&&(n&Ma)===0)return;if((n&(Nt|nt))!==0){if((n&oe)===0)return;t.f^=oe}}Me.push(t)}function Gl(e){let t=0,n=Mt(0),r;return()=>{Hn()&&(p(n),Cr(()=>(t===0&&(r=we(()=>e(()=>On(n)))),t+=1,()=>{Lt(()=>{t-=1,t===0&&(r?.(),r=void 0,On(n))})})))}}var Ul=ht|vn|Fr;function Ol(e,t,n){new zl(e,t,n)}class zl{parent;#e=!1;#t;#r=null;#n;#u;#i;#o=null;#s=null;#a=null;#c=null;#l=null;#f=0;#d=0;#m=!1;#h=null;#x=Gl(()=>(this.#h=Mt(this.#f),()=>{this.#h=null}));constructor(t,n,r){this.#t=t,this.#n=n,this.#u=r,this.parent=O.b,this.#e=!!this.#n.pending,this.#i=Ir(()=>{O.b=this;{var o=this.#p();try{this.#o=Ee(()=>r(o))}catch(i){this.error(i)}this.#d>0?this.#v():this.#e=!1}return()=>{this.#l?.remove()}},Ul)}#g(){try{this.#o=Ee(()=>this.#u(this.#t))}catch(t){this.error(t)}this.#e=!1}#y(){const t=this.#n.pending;t&&(this.#s=Ee(()=>t(this.#t)),ke.enqueue(()=>{var n=this.#p();this.#o=this.#_(()=>(ke.ensure(),Ee(()=>this.#u(n)))),this.#d>0?this.#v():(Pt(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#p(){var t=this.#t;return this.#e&&(this.#l=ft(),this.#t.before(this.#l),t=this.#l),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#_(t){var n=O,r=G,o=q;Ge(this.#i),de(this.#i),dn(this.#i.ctx);try{return t()}catch(i){return Ua(i),null}finally{Ge(n),de(r),dn(o)}}#v(){const t=this.#n.pending;this.#o!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#l),ru(this.#o,this.#c)),this.#s===null&&(this.#s=Ee(()=>t(this.#t)))}#b(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#b(t);return}this.#d+=t,this.#d===0&&(this.#e=!1,this.#s&&Pt(this.#s,()=>{this.#s=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#b(t),this.#f+=t,this.#h&&kt(this.#h,this.#f)}get_effect_pending(){return this.#x(),p(this.#h)}error(t){var n=this.#n.onerror;let r=this.#n.failed;if(this.#m||!n&&!r)throw t;this.#o&&(he(this.#o),this.#o=null),this.#s&&(he(this.#s),this.#s=null),this.#a&&(he(this.#a),this.#a=null);var o=!1,i=!1;const a=()=>{if(o){Cl();return}o=!0,i&&pl(),ke.ensure(),this.#f=0,this.#a!==null&&Pt(this.#a,()=>{this.#a=null}),this.#e=this.has_pending_snippet(),this.#o=this.#_(()=>(this.#m=!1,Ee(()=>this.#u(this.#t)))),this.#d>0?this.#v():this.#e=!1};var s=G;try{de(null),i=!0,n?.(t,a),i=!1}catch(u){hn(u,this.#i&&this.#i.parent)}finally{de(s)}r&&Lt(()=>{this.#a=this.#_(()=>{ke.ensure(),this.#m=!0;try{return Ee(()=>{r(this.#t,()=>t,()=>a)})}catch(u){return hn(u,this.#i.parent),null}finally{this.#m=!1}})})}}function Vl(e,t,n,r){const o=Kn()?Pr:at;if(n.length===0&&e.length===0){r(t.map(o));return}var i=H,a=O,s=Hl();function u(){Promise.all(n.map(c=>Xl(c))).then(c=>{s();try{r([...t.map(o),...c])}catch(l){(a.f&Qe)===0&&hn(l,a)}i?.deactivate(),_r()}).catch(c=>{hn(c,a)})}e.length>0?Promise.all(e).then(()=>{s();try{return u()}finally{i?.deactivate(),_r()}}):u()}function Hl(){var e=O,t=G,n=q,r=H;return function(i=!0){Ge(e),de(t),dn(n),i&&r?.activate()}}function _r(){Ge(null),de(null),dn(null)}function Pr(e){var t=se|me,n=G!==null&&(G.f&se)!==0?G:null;return O!==null&&(O.f|=vn),{ctx:q,deps:null,effects:null,equals:La,f:t,fn:e,reactions:null,rv:0,v:ue,wv:0,parent:n??O,ac:null}}function Xl(e,t){let n=O;n===null&&ul();var r=n.b,o=void 0,i=Mt(ue),a=!G,s=new Map;return tf(()=>{var u=Da();o=u.promise;try{Promise.resolve(e()).then(u.resolve,u.reject).then(()=>{c===H&&c.committed&&c.deactivate(),_r()})}catch(f){u.reject(f),_r()}var c=H;if(a){var l=!r.is_pending();r.update_pending_count(1),c.increment(l),s.get(c)?.reject(sn),s.delete(c),s.set(c,u)}const d=(f,h=void 0)=>{if(c.activate(),h)h!==sn&&(i.f|=ct,kt(i,h));else{(i.f&ct)!==0&&(i.f^=ct),kt(i,f);for(const[m,_]of s){if(s.delete(m),m===c)break;_.reject(sn)}}a&&(r.update_pending_count(-1),c.decrement(l))};u.promise.then(d,f=>d(null,f||"unknown"))}),Br(()=>{for(const u of s.values())u.reject(sn)}),new Promise(u=>{function c(l){function d(){l===o?u(i):c(o)}l.then(d,d)}c(o)})}function at(e){const t=Pr(e);return t.equals=Ga,t}function Va(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)he(t[n])}}function $l(e){for(var t=e.parent;t!==null;){if((t.f&se)===0)return(t.f&Qe)===0?t:null;t=t.parent}return null}function jo(e){var t,n=O;Ge($l(e));try{e.f&=~It,Va(e),t=au(e)}finally{Ge(n)}return t}function Ha(e){var t=jo(e);if(e.equals(t)||(H?.is_fork||(e.v=t),e.wv=iu()),!Gt)if(Re!==null)(Hn()||H?.is_fork)&&Re.set(e,t);else{var n=(e.f&Ae)===0?Fe:oe;ie(e,n)}}let Co=new Set;const lt=new Map;let Xa=!1;function Mt(e,t){var n={f:0,v:e,reactions:null,equals:La,rv:0,wv:0};return n}function rt(e,t){const n=Mt(e);return sf(n),n}function M(e,t=!1,n=!0){const r=Mt(e);return t||(r.equals=Ga),pn&&n&&q!==null&&q.l!==null&&(q.l.s??=[]).push(r),r}function S(e,t,n=!1){G!==null&&(!Ne||(G.f&Xi)!==0)&&Kn()&&(G.f&(se|ze|Yo|Xi))!==0&&!Je?.includes(e)&&vl();let r=n?un(t):t;return kt(e,r)}function kt(e,t){if(!e.equals(t)){var n=e.v;Gt?lt.set(e,t):lt.set(e,n),e.v=t;var r=ke.ensure();r.capture(e,n),(e.f&se)!==0&&((e.f&me)!==0&&jo(e),ie(e,(e.f&Ae)!==0?oe:Fe)),e.wv=iu(),$a(e,me),Kn()&&O!==null&&(O.f&oe)!==0&&(O.f&(nt|Nt))===0&&(ye===null?af([e]):ye.push(e)),!r.is_fork&&Co.size>0&&!Xa&&ql()}return t}function ql(){Xa=!1;var e=Bt;vr(!0);const t=Array.from(Co);try{for(const n of t)(n.f&oe)!==0&&ie(n,Fe),xn(n)&&mn(n)}finally{vr(e)}Co.clear()}function On(e){S(e,e.v+1)}function $a(e,t){var n=e.reactions;if(n!==null)for(var r=Kn(),o=n.length,i=0;i<o;i++){var a=n[i],s=a.f;if(!(!r&&a===O)){var u=(s&me)===0;if(u&&ie(a,t),(s&se)!==0){var c=a;Re?.delete(c),(s&It)===0&&(s&Ae&&(a.f|=It),$a(c,Fe))}else u&&((s&ze)!==0&&Ke!==null&&Ke.add(a),Dt(a))}}}function un(e){if(typeof e!="object"||e===null||Ze in e)return e;const t=$o(e);if(t!==tl&&t!==nl)return e;var n=new Map,r=Sr(e),o=rt(0),i=Ct,a=s=>{if(Ct===i)return s();var u=G,c=Ct;de(null),Qi(i);var l=s();return de(u),Qi(c),l};return r&&n.set("length",rt(e.length)),new Proxy(e,{defineProperty(s,u,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&ml();var l=n.get(u);return l===void 0?l=a(()=>{var d=rt(c.value);return n.set(u,d),d}):S(l,c.value,!0),!0},deleteProperty(s,u){var c=n.get(u);if(c===void 0){if(u in s){const l=a(()=>rt(ue));n.set(u,l),On(o)}}else S(c,ue),On(o);return!0},get(s,u,c){if(u===Ze)return e;var l=n.get(u),d=u in s;if(l===void 0&&(!d||wt(s,u)?.writable)&&(l=a(()=>{var h=un(d?s[u]:ue),m=rt(h);return m}),n.set(u,l)),l!==void 0){var f=p(l);return f===ue?void 0:f}return Reflect.get(s,u,c)},getOwnPropertyDescriptor(s,u){var c=Reflect.getOwnPropertyDescriptor(s,u);if(c&&"value"in c){var l=n.get(u);l&&(c.value=p(l))}else if(c===void 0){var d=n.get(u),f=d?.v;if(d!==void 0&&f!==ue)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return c},has(s,u){if(u===Ze)return!0;var c=n.get(u),l=c!==void 0&&c.v!==ue||Reflect.has(s,u);if(c!==void 0||O!==null&&(!l||wt(s,u)?.writable)){c===void 0&&(c=a(()=>{var f=l?un(s[u]):ue,h=rt(f);return h}),n.set(u,c));var d=p(c);if(d===ue)return!1}return l},set(s,u,c,l){var d=n.get(u),f=u in s;if(r&&u==="length")for(var h=c;h<d.v;h+=1){var m=n.get(h+"");m!==void 0?S(m,ue):h in s&&(m=a(()=>rt(ue)),n.set(h+"",m))}if(d===void 0)(!f||wt(s,u)?.writable)&&(d=a(()=>rt(void 0)),S(d,un(c)),n.set(u,d));else{f=d.v!==ue;var _=a(()=>un(c));S(d,_)}var v=Reflect.getOwnPropertyDescriptor(s,u);if(v?.set&&v.set.call(l,c),!f){if(r&&typeof u=="string"){var b=n.get("length"),y=Number(u);Number.isInteger(y)&&y>=b.v&&S(b,y+1)}On(o)}return!0},ownKeys(s){p(o);var u=Reflect.ownKeys(s).filter(d=>{var f=n.get(d);return f===void 0||f.v!==ue});for(var[c,l]of n)l.v!==ue&&!(c in s)&&u.push(c);return u},setPrototypeOf(){_l()}})}function qi(e){try{if(e!==null&&typeof e=="object"&&Ze in e)return e[Ze]}catch{}return e}function Yl(e,t){return Object.is(qi(e),qi(t))}var Yi,qa,Ya,Ka;function Kl(){if(Yi===void 0){Yi=window,qa=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ya=wt(t,"firstChild").get,Ka=wt(t,"nextSibling").get,Hi(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Hi(n)&&(n.__t=void 0)}}function ft(e=""){return document.createTextNode(e)}function Qo(e){return Ya.call(e)}function Wn(e){return Ka.call(e)}function L(e,t){return Qo(e)}function ne(e,t=!1){{var n=Qo(e);return n instanceof Comment&&n.data===""?Wn(n):n}}function z(e,t=1,n=!1){let r=e;for(;t--;)r=Wn(r);return r}function Wl(e){e.textContent=""}function Wa(){return!1}let Ki=!1;function jl(){Ki||(Ki=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function bn(e){var t=G,n=O;de(null),Ge(null);try{return e()}finally{de(t),Ge(n)}}function Ql(e,t,n,r=n){e.addEventListener(t,()=>bn(n));const o=e.__on_r;o?e.__on_r=()=>{o(),r(!0)}:e.__on_r=()=>r(!0),jl()}function ja(e){O===null&&(G===null&&fl(),ll()),Gt&&cl()}function Zl(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Ve(e,t,n){var r=O;r!==null&&(r.f&xe)!==0&&(e|=xe);var o={ctx:q,deps:null,nodes:null,f:e|me|Ae,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{mn(o),o.f|=wr}catch(s){throw he(o),s}else t!==null&&Dt(o);var i=o;if(n&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&vn)===0&&(i=i.first,(e&ze)!==0&&(e&ht)!==0&&i!==null&&(i.f|=ht)),i!==null&&(i.parent=r,r!==null&&Zl(i,r),G!==null&&(G.f&se)!==0&&(e&Nt)===0)){var a=G;(a.effects??=[]).push(i)}return o}function Hn(){return G!==null&&!Ne}function Br(e){const t=Ve(Ar,null,!1);return ie(t,oe),t.teardown=e,t}function Io(e){ja();var t=O.f,n=!G&&(t&nt)!==0&&(t&wr)===0;if(n){var r=q;(r.e??=[]).push(e)}else return Qa(e)}function Qa(e){return Ve(qo|ka,e,!1)}function Jl(e){return ja(),Ve(Ar|ka,e,!0)}function ef(e){ke.ensure();const t=Ve(Nt|vn,e,!0);return(n={})=>new Promise(r=>{n.outro?Pt(t,()=>{he(t),r(void 0)}):(he(t),r(void 0))})}function Zo(e){return Ve(qo,e,!1)}function _t(e,t){var n=q,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=Cr(()=>{e(),!r.ran&&(r.ran=!0,we(t))})}function vt(){var e=q;Cr(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&oe)!==0&&ie(n,Fe),xn(n)&&mn(n),t.ran=!1}})}function tf(e){return Ve(Yo|vn,e,!0)}function Cr(e,t=0){return Ve(Ar|t,e,!0)}function Te(e,t=[],n=[],r=[]){Vl(r,t,n,o=>{Ve(Ar,()=>e(...o.map(p)),!0)})}function Ir(e,t=0){var n=Ve(ze|t,e,!0);return n}function Ee(e){return Ve(nt|vn,e,!0)}function Za(e){var t=e.teardown;if(t!==null){const n=Gt,r=G;ji(!0),de(null);try{t.call(null)}finally{ji(n),de(r)}}}function Ja(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const o=n.ac;o!==null&&bn(()=>{o.abort(sn)});var r=n.next;(n.f&Nt)!==0?n.parent=null:he(n,t),n=r}}function nf(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&nt)===0&&he(t),t=n}}function he(e,t=!0){var n=!1;(t||(e.f&Ma)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(rf(e.nodes.start,e.nodes.end),n=!0),Ja(e,t&&!n),pr(e,0),ie(e,Qe);var r=e.nodes&&e.nodes.t;if(r!==null)for(const i of r)i.stop();Za(e);var o=e.parent;o!==null&&o.first!==null&&eu(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function rf(e,t){for(;e!==null;){var n=e===t?null:Wn(e);e.remove(),e=n}}function eu(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Pt(e,t,n=!0){var r=[];tu(e,r,!0);var o=()=>{n&&he(e),t&&t()},i=r.length;if(i>0){var a=()=>--i||o();for(var s of r)s.out(a)}else o()}function tu(e,t,n){if((e.f&xe)===0){e.f^=xe;var r=e.nodes&&e.nodes.t;if(r!==null)for(const s of r)(s.is_global||n)&&t.push(s);for(var o=e.first;o!==null;){var i=o.next,a=(o.f&ht)!==0||(o.f&nt)!==0&&(e.f&ze)!==0;tu(o,t,a?n:!1),o=i}}}function Jo(e){nu(e,!0)}function nu(e,t){if((e.f&xe)!==0){e.f^=xe,(e.f&oe)===0&&(ie(e,me),Dt(e));for(var n=e.first;n!==null;){var r=n.next,o=(n.f&ht)!==0||(n.f&nt)!==0;nu(n,o?t:!1),n=r}var i=e.nodes&&e.nodes.t;if(i!==null)for(const a of i)(a.is_global||t)&&a.in()}}function ru(e,t){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end;n!==null;){var o=n===r?null:Wn(n);t.append(n),n=o}}let on=null;function of(e){var t=on;try{if(on=new Set,we(e),t!==null)for(var n of on)t.add(n);return on}finally{on=t}}function Wi(e){for(var t of of(e))kt(t,t.v)}let Bt=!1;function vr(e){Bt=e}let Gt=!1;function ji(e){Gt=e}let G=null,Ne=!1;function de(e){G=e}let O=null;function Ge(e){O=e}let Je=null;function sf(e){G!==null&&(Je===null?Je=[e]:Je.push(e))}let ce=null,be=0,ye=null;function af(e){ye=e}let ou=1,Xn=0,Ct=Xn;function Qi(e){Ct=e}function iu(){return++ou}function xn(e){var t=e.f;if((t&me)!==0)return!0;if(t&se&&(e.f&=~It),(t&Fe)!==0){var n=e.deps;if(n!==null)for(var r=n.length,o=0;o<r;o++){var i=n[o];if(xn(i)&&Ha(i),i.wv>e.wv)return!0}(t&Ae)!==0&&Re===null&&ie(e,oe)}return!1}function su(e,t,n=!0){var r=e.reactions;if(r!==null&&!Je?.includes(e))for(var o=0;o<r.length;o++){var i=r[o];(i.f&se)!==0?su(i,t,!1):t===i&&(n?ie(i,me):(i.f&oe)!==0&&ie(i,Fe),Dt(i))}}function au(e){var t=ce,n=be,r=ye,o=G,i=Je,a=q,s=Ne,u=Ct,c=e.f;ce=null,be=0,ye=null,G=(c&(nt|Nt))===0?e:null,Je=null,dn(e.ctx),Ne=!1,Ct=++Xn,e.ac!==null&&(bn(()=>{e.ac.abort(sn)}),e.ac=null);try{e.f|=Po;var l=e.fn,d=l(),f=e.deps;if(ce!==null){var h;if(pr(e,be),f!==null&&be>0)for(f.length=be+ce.length,h=0;h<ce.length;h++)f[be+h]=ce[h];else e.deps=f=ce;if(Hn()&&(e.f&Ae)!==0)for(h=be;h<f.length;h++)(f[h].reactions??=[]).push(e)}else f!==null&&be<f.length&&(pr(e,be),f.length=be);if(Kn()&&ye!==null&&!Ne&&f!==null&&(e.f&(se|Fe|me))===0)for(h=0;h<ye.length;h++)su(ye[h],e);return o!==null&&o!==e&&(Xn++,ye!==null&&(r===null?r=ye:r.push(...ye))),(e.f&ct)!==0&&(e.f^=ct),d}catch(m){return Ua(m)}finally{e.f^=Po,ce=t,be=n,ye=r,G=o,Je=i,dn(a),Ne=s,Ct=u}}function uf(e,t){let n=t.reactions;if(n!==null){var r=Jc.call(n,e);if(r!==-1){var o=n.length-1;o===0?n=t.reactions=null:(n[r]=n[o],n.pop())}}n===null&&(t.f&se)!==0&&(ce===null||!ce.includes(t))&&(ie(t,Fe),(t.f&Ae)!==0&&(t.f^=Ae,t.f&=~It),Va(t),pr(t,0))}function pr(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)uf(e,n[r])}function mn(e){var t=e.f;if((t&Qe)===0){ie(e,oe);var n=O,r=Bt;O=e,Bt=!0;try{(t&(ze|il))!==0?nf(e):Ja(e),Za(e);var o=au(e);e.teardown=typeof o=="function"?o:null,e.wv=ou;var i;Fo&&Dl&&(e.f&me)!==0&&e.deps}finally{Bt=r,O=n}}}function p(e){var t=e.f,n=(t&se)!==0;if(on?.add(e),G!==null&&!Ne){var r=O!==null&&(O.f&Qe)!==0;if(!r&&!Je?.includes(e)){var o=G.deps;if((G.f&Po)!==0)e.rv<Xn&&(e.rv=Xn,ce===null&&o!==null&&o[be]===e?be++:ce===null?ce=[e]:ce.includes(e)||ce.push(e));else{(G.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[G]:i.includes(G)||i.push(G)}}}if(Gt){if(lt.has(e))return lt.get(e);if(n){var a=e,s=a.v;return((a.f&oe)===0&&a.reactions!==null||cu(a))&&(s=jo(a)),lt.set(a,s),s}}else n&&(!Re?.has(e)||H?.is_fork&&!Hn())&&(a=e,xn(a)&&Ha(a),Bt&&Hn()&&(a.f&Ae)===0&&uu(a));if(Re?.has(e))return Re.get(e);if((e.f&ct)!==0)throw e.v;return e.v}function uu(e){if(e.deps!==null){e.f^=Ae;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&se)!==0&&(t.f&Ae)===0&&uu(t)}}function cu(e){if(e.v===ue)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(lt.has(t)||(t.f&se)!==0&&cu(t))return!0;return!1}function we(e){var t=Ne;try{return Ne=!0,e()}finally{Ne=t}}const cf=-7169;function ie(e,t){e.f=e.f&cf|t}function Pe(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Ze in e)Do(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Ze in n&&Do(n)}}}function Do(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{Do(e[r],t)}catch{}const n=$o(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=Ia(n);for(let o in r){const i=r[o].get;if(i)try{i.call(e)}catch{}}}}}const lf=["touchstart","touchmove"];function ff(e){return lf.includes(e)}const df=new Set,Zi=new Set;function hf(e,t,n,r={}){function o(i){if(r.capture||Gn.call(t,i),!i.cancelBubble)return bn(()=>n?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Lt(()=>{t.addEventListener(e,o,r)}):t.addEventListener(e,o,r),o}function cn(e,t,n,r,o){var i={capture:r,passive:o},a=hf(e,t,n,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Br(()=>{t.removeEventListener(e,a,i)})}let Ji=null;function Gn(e){var t=this,n=t.ownerDocument,r=e.type,o=e.composedPath?.()||[],i=o[0]||e.target;Ji=e;var a=0,s=Ji===e&&e.__root;if(s){var u=o.indexOf(s);if(u!==-1&&(t===document||t===window)){e.__root=t;return}var c=o.indexOf(t);if(c===-1)return;u<=c&&(a=u)}if(i=o[a]||e.target,i!==t){el(e,"currentTarget",{configurable:!0,get(){return i||n}});var l=G,d=O;de(null),Ge(null);try{for(var f,h=[];i!==null;){var m=i.assignedSlot||i.parentNode||i.host||null;try{var _=i["__"+r];_!=null&&(!i.disabled||e.target===i)&&_.call(i,e)}catch(v){f?h.push(v):f=v}if(e.cancelBubble||m===t||m===null)break;i=m}if(f){for(let v of h)queueMicrotask(()=>{throw v});throw f}}finally{e.__root=t,delete e.currentTarget,de(l),Ge(d)}}}function mf(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function lu(e,t){var n=O;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function ee(e,t){var n=(t&wl)!==0,r,o=!e.startsWith("<!>");return()=>{r===void 0&&(r=mf(o?e:"<!>"+e),r=Qo(r));var i=n||qa?document.importNode(r,!0):r.cloneNode(!0);return lu(i,i),i}}function re(){var e=document.createDocumentFragment(),t=document.createComment(""),n=ft();return e.append(t,n),lu(t,n),e}function N(e,t){e!==null&&e.before(t)}let Mo=!0;function et(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function _f(e,t){return vf(e,t)}const Jt=new Map;function vf(e,{target:t,anchor:n,props:r={},events:o,context:i,intro:a=!0}){Kl();var s=new Set,u=d=>{for(var f=0;f<d.length;f++){var h=d[f];if(!s.has(h)){s.add(h);var m=ff(h);t.addEventListener(h,Gn,{passive:m});var _=Jt.get(h);_===void 0?(document.addEventListener(h,Gn,{passive:m}),Jt.set(h,1)):Jt.set(h,_+1)}}};u(Tr(df)),Zi.add(u);var c=void 0,l=ef(()=>{var d=n??t.appendChild(ft());return Ol(d,{pending:()=>{}},f=>{if(i){_e({});var h=q;h.c=i}o&&(r.$$events=o),Mo=a,c=e(f,r)||{},Mo=!0,i&&ve()}),()=>{for(var f of s){t.removeEventListener(f,Gn);var h=Jt.get(f);--h===0?(document.removeEventListener(f,Gn),Jt.delete(f)):Jt.set(f,h)}Zi.delete(u),d!==n&&d.parentNode?.removeChild(d)}});return pf.set(c,l),c}let pf=new WeakMap;class fu{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#u=!0;constructor(t,n=!0){this.anchor=t,this.#u=n}#i=()=>{var t=H;if(this.#e.has(t)){var n=this.#e.get(t),r=this.#t.get(n);if(r)Jo(r),this.#n.delete(n);else{var o=this.#r.get(n);o&&(this.#t.set(n,o.effect),this.#r.delete(n),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),r=o.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===t)break;const s=this.#r.get(a);s&&(he(s.effect),this.#r.delete(a))}for(const[i,a]of this.#t){if(i===n||this.#n.has(i))continue;const s=()=>{if(Array.from(this.#e.values()).includes(i)){var c=document.createDocumentFragment();ru(a,c),c.append(ft()),this.#r.set(i,{effect:a,fragment:c})}else he(a);this.#n.delete(i),this.#t.delete(i)};this.#u||!r?(this.#n.add(i),Pt(a,s,!1)):s()}}};#o=t=>{this.#e.delete(t);const n=Array.from(this.#e.values());for(const[r,o]of this.#r)n.includes(r)||(he(o.effect),this.#r.delete(r))};ensure(t,n){var r=H,o=Wa();if(n&&!this.#t.has(t)&&!this.#r.has(t))if(o){var i=document.createDocumentFragment(),a=ft();i.append(a),this.#r.set(t,{effect:Ee(()=>n(a)),fragment:i})}else this.#t.set(t,Ee(()=>n(this.anchor)));if(this.#e.set(r,t),o){for(const[s,u]of this.#t)s===t?r.skipped_effects.delete(u):r.skipped_effects.add(u);for(const[s,u]of this.#r)s===t?r.skipped_effects.delete(u.effect):r.skipped_effects.add(u.effect);r.oncommit(this.#i),r.ondiscard(this.#o)}else this.#i()}}function J(e,t,n=!1){var r=new fu(e),o=n?ht:0;function i(a,s){r.ensure(a,s)}Ir(()=>{var a=!1;t((s,u=!0)=>{a=!0,i(u,s)}),a||i(!1,null)},o)}function bf(e,t,n){for(var r=[],o=t.length,i,a=t.length,s=0;s<o;s++){let d=t[s];Pt(d,()=>{if(i){if(i.pending.delete(d),i.done.add(d),i.pending.size===0){var f=e.outrogroups;ko(Tr(i.done)),f.delete(i),f.size===0&&(e.outrogroups=null)}}else a-=1},!1)}if(a===0){var u=r.length===0&&n!==null;if(u){var c=n,l=c.parentNode;Wl(l),l.append(c),e.items.clear()}ko(t,!u)}else i={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(i)}function ko(e,t=!0){for(var n=0;n<e.length;n++)he(e[n],t)}var es;function No(e,t,n,r,o,i=null){var a=e,s=new Map,u=(t&Na)!==0;if(u){var c=e;a=c.appendChild(ft())}var l=null,d=at(()=>{var b=n();return Sr(b)?b:b==null?[]:Tr(b)}),f,h=!0;function m(){v.fallback=l,xf(v,f,a,t,r),l!==null&&(f.length===0?(l.f&je)===0?Jo(l):(l.f^=je,Un(l,null,a)):Pt(l,()=>{l=null}))}var _=Ir(()=>{f=p(d);for(var b=f.length,y=new Set,g=H,R=Wa(),x=0;x<b;x+=1){var T=f[x],F=r(T,x),B=h?null:s.get(F);B?(B.v&&kt(B.v,T),B.i&&kt(B.i,x),R&&g.skipped_effects.delete(B.e)):(B=gf(s,h?a:es??=ft(),T,F,x,o,t,n),h||(B.e.f|=je),s.set(F,B)),y.add(F)}if(b===0&&i&&!l&&(h?l=Ee(()=>i(a)):(l=Ee(()=>i(es??=ft())),l.f|=je)),!h)if(R){for(const[E,A]of s)y.has(E)||g.skipped_effects.add(A.e);g.oncommit(m),g.ondiscard(()=>{})}else m();p(d)}),v={effect:_,items:s,outrogroups:null,fallback:l};h=!1}function xf(e,t,n,r,o){var i=(r&gl)!==0,a=t.length,s=e.items,u=e.effect.first,c,l=null,d,f=[],h=[],m,_,v,b;if(i)for(b=0;b<a;b+=1)m=t[b],_=o(m,b),v=s.get(_).e,(v.f&je)===0&&(v.nodes?.a?.measure(),(d??=new Set).add(v));for(b=0;b<a;b+=1){if(m=t[b],_=o(m,b),v=s.get(_).e,e.outrogroups!==null)for(const A of e.outrogroups)A.pending.delete(v),A.done.delete(v);if((v.f&je)!==0)if(v.f^=je,v===u)Un(v,null,n);else{var y=l?l.next:u;v===e.effect.last&&(e.effect.last=v.prev),v.prev&&(v.prev.next=v.next),v.next&&(v.next.prev=v.prev),ot(e,l,v),ot(e,v,y),Un(v,y,n),l=v,f=[],h=[],u=l.next;continue}if((v.f&xe)!==0&&(Jo(v),i&&(v.nodes?.a?.unfix(),(d??=new Set).delete(v))),v!==u){if(c!==void 0&&c.has(v)){if(f.length<h.length){var g=h[0],R;l=g.prev;var x=f[0],T=f[f.length-1];for(R=0;R<f.length;R+=1)Un(f[R],g,n);for(R=0;R<h.length;R+=1)c.delete(h[R]);ot(e,x.prev,T.next),ot(e,l,x),ot(e,T,g),u=g,l=T,b-=1,f=[],h=[]}else c.delete(v),Un(v,u,n),ot(e,v.prev,v.next),ot(e,v,l===null?e.effect.first:l.next),ot(e,l,v),l=v;continue}for(f=[],h=[];u!==null&&u!==v;)(c??=new Set).add(u),h.push(u),u=u.next;if(u===null)continue}(v.f&je)===0&&f.push(v),l=v,u=v.next}if(e.outrogroups!==null){for(const A of e.outrogroups)A.pending.size===0&&(ko(Tr(A.done)),e.outrogroups?.delete(A));e.outrogroups.size===0&&(e.outrogroups=null)}if(u!==null||c!==void 0){var F=[];if(c!==void 0)for(v of c)(v.f&xe)===0&&F.push(v);for(;u!==null;)(u.f&xe)===0&&u!==e.fallback&&F.push(u),u=u.next;var B=F.length;if(B>0){var E=(r&Na)!==0&&a===0?n:null;if(i){for(b=0;b<B;b+=1)F[b].nodes?.a?.measure();for(b=0;b<B;b+=1)F[b].nodes?.a?.fix()}bf(e,F,E)}}i&&Lt(()=>{if(d!==void 0)for(v of d)v.nodes?.a?.apply()})}function gf(e,t,n,r,o,i,a,s){var u=(a&bl)!==0?(a&yl)===0?M(n,!1,!1):Mt(n):null,c=(a&xl)!==0?Mt(o):null;return{v:u,i:c,e:Ee(()=>(i(t,u??n,c??o,s),()=>{e.delete(r)}))}}function Un(e,t,n){if(e.nodes)for(var r=e.nodes.start,o=e.nodes.end,i=t&&(t.f&je)===0?t.nodes.start:n;r!==null;){var a=Wn(r);if(i.before(r),r===o)return;r=a}}function ot(e,t,n){t===null?e.effect.first=n:t.next=n,n===null?e.effect.last=t:n.prev=t}function it(e,t,n){var r=new fu(e);Ir(()=>{var o=t()??null;r.ensure(o,o&&(i=>n(i,o)))},ht)}const yf=()=>performance.now(),We={tick:e=>requestAnimationFrame(e),now:()=>yf(),tasks:new Set};function du(){const e=We.now();We.tasks.forEach(t=>{t.c(e)||(We.tasks.delete(t),t.f())}),We.tasks.size!==0&&We.tick(du)}function Ef(e){let t;return We.tasks.size===0&&We.tick(du),{promise:new Promise(n=>{We.tasks.add(t={c:e,f:n})}),abort(){We.tasks.delete(t)}}}function er(e,t){bn(()=>{e.dispatchEvent(new CustomEvent(t))})}function Rf(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function ts(e){const t={},n=e.split(";");for(const r of n){const[o,i]=r.split(":");if(!o||i===void 0)break;const a=Rf(o.trim());t[a]=i.trim()}return t}const Sf=e=>e;function Tf(e,t,n,r){var o=(e&Fl)!==0,i="both",a,s=t.inert,u=t.style.overflow,c,l;function d(){return bn(()=>a??=n()(t,r?.()??{},{direction:i}))}var f={is_global:o,in(){t.inert=s,er(t,"introstart"),c=Lo(t,d(),l,1,()=>{er(t,"introend"),c?.abort(),c=a=void 0,t.style.overflow=u})},out(v){t.inert=!0,er(t,"outrostart"),l=Lo(t,d(),c,0,()=>{er(t,"outroend"),v?.()})},stop:()=>{c?.abort(),l?.abort()}},h=O;if((h.nodes.t??=[]).push(f),Mo){var m=o;if(!m){for(var _=h.parent;_&&(_.f&ht)!==0;)for(;(_=_.parent)&&(_.f&ze)===0;);m=!_||(_.f&wr)!==0}m&&Zo(()=>{we(()=>f.in())})}}function Lo(e,t,n,r,o){var i=r===1;if(rl(t)){var a,s=!1;return Lt(()=>{if(!s){var v=t({direction:i?"in":"out"});a=Lo(e,v,n,r,o)}}),{abort:()=>{s=!0,a?.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(n?.deactivate(),!t?.duration)return o(),{abort:In,deactivate:In,reset:In,t:()=>r};const{delay:u=0,css:c,tick:l,easing:d=Sf}=t;var f=[];if(i&&n===void 0&&(l&&l(0,1),c)){var h=ts(c(0,1));f.push(h,h)}var m=()=>1-r,_=e.animate(f,{duration:u,fill:"forwards"});return _.onfinish=()=>{_.cancel();var v=n?.t()??1-r;n?.abort();var b=r-v,y=t.duration*Math.abs(b),g=[];if(y>0){var R=!1;if(c)for(var x=Math.ceil(y/16.666666666666668),T=0;T<=x;T+=1){var F=v+b*d(T/x),B=ts(c(F,1-F));g.push(B),R||=B.overflow==="hidden"}R&&(e.style.overflow="hidden"),m=()=>{var E=_.currentTime;return v+b*d(E/y)},l&&Ef(()=>{if(_.playState!=="running")return!1;var E=m();return l(E,1-E),!0})}_=e.animate(g,{duration:y,fill:"forwards"}),_.onfinish=()=>{m=()=>r,l?.(r,1-r),o()}},{abort:()=>{_&&(_.cancel(),_.effect=null,_.onfinish=In)},deactivate:()=>{o=In},reset:()=>{r===0&&l?.(1,0)},t:()=>m()}}const ns=[...` 	
\r\fÂ \v\uFEFF`];function Af(e,t,n){var r=e==null?"":""+e;if(n){for(var o in n)if(n[o])r=r?r+" "+o:o;else if(r.length)for(var i=o.length,a=0;(a=r.indexOf(o,a))>=0;){var s=a+i;(a===0||ns.includes(r[a-1]))&&(s===r.length||ns.includes(r[s]))?r=(a===0?"":r.substring(0,a))+r.substring(s+1):a=s}}return r===""?null:r}function Go(e,t,n,r,o,i){var a=e.__className;if(a!==n||a===void 0){var s=Af(n,r,i);s==null?e.removeAttribute("class"):e.className=s,e.__className=n}else if(i&&o!==i)for(var u in i){var c=!!i[u];(o==null||c!==!!o[u])&&e.classList.toggle(u,c)}return i}function hu(e,t,n=!1){if(e.multiple){if(t==null)return;if(!Sr(t))return Bl();for(var r of e.options)r.selected=t.includes(zn(r));return}for(r of e.options){var o=zn(r);if(Yl(o,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Ff(e){var t=new MutationObserver(()=>{hu(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Br(()=>{t.disconnect()})}function rs(e,t,n=t){var r=new WeakSet,o=!0;Ql(e,"change",i=>{var a=i?"[selected]":":checked",s;if(e.multiple)s=[].map.call(e.querySelectorAll(a),zn);else{var u=e.querySelector(a)??e.querySelector("option:not([disabled])");s=u&&zn(u)}n(s),H!==null&&r.add(H)}),Zo(()=>{var i=t();if(e===document.activeElement){var a=cr??H;if(r.has(a))return}if(hu(e,i,o),o&&i===void 0){var s=e.querySelector(":checked");s!==null&&(i=zn(s),n(i))}e.__value=i,o=!1}),Ff(e)}function zn(e){return"__value"in e?e.__value:e.value}const wf=Symbol("is custom element"),Pf=Symbol("is html");function Bf(e,t){var n=ei(e);n.value===(n.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function Cf(e,t){var n=ei(e);n.checked!==(n.checked=t??void 0)&&(e.checked=t)}function lr(e,t,n,r){var o=ei(e);o[t]!==(o[t]=n)&&(t==="loading"&&(e[al]=n),n==null?e.removeAttribute(t):typeof n!="string"&&If(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function ei(e){return e.__attributes??={[wf]:e.nodeName.includes("-"),[Pf]:e.namespaceURI===Pl}}var os=new Map;function If(e){var t=e.getAttribute("is")||e.nodeName,n=os.get(t);if(n)return n;os.set(t,n=[]);for(var r,o=e,i=Element.prototype;i!==o;){r=Ia(o);for(var a in r)r[a].set&&n.push(a);o=$o(o)}return n}function Df(e,t,n){var r=wt(e,t);r&&r.set&&(e[t]=n,Br(()=>{e[t]=null}))}function is(e,t){return e===t||e?.[Ze]===t}function go(e={},t,n,r){return Zo(()=>{var o,i;return Cr(()=>{o=i,i=[],we(()=>{e!==n(...i)&&(t(e,...i),o&&is(n(...o),e)&&t(null,...o))})}),()=>{Lt(()=>{i&&is(n(...i),e)&&t(null,...i)})}}),e}function Ce(e=!1){const t=q,n=t.l.u;if(!n)return;let r=()=>Pe(t.s);if(e){let o=0,i={};const a=Pr(()=>{let s=!1;const u=t.s;for(const c in u)u[c]!==i[c]&&(i[c]=u[c],s=!0);return s&&o++,o});r=()=>p(a)}n.b.length&&Jl(()=>{ss(t,r),wo(n.b)}),Io(()=>{const o=we(()=>n.m.map(ol));return()=>{for(const i of o)typeof i=="function"&&i()}}),n.a.length&&Io(()=>{ss(t,r),wo(n.a)})}function ss(e,t){if(e.l.s)for(const n of e.l.s)p(n);t()}let tr=!1;function Mf(e){var t=tr;try{return tr=!1,[e(),tr]}finally{tr=t}}function X(e,t,n,r){var o=!pn||(n&Rl)!==0,i=(n&Tl)!==0,a=(n&Al)!==0,s=r,u=!0,c=()=>(u&&(u=!1,s=a?we(r):r),s),l;if(i){var d=Ze in e||sl in e;l=wt(e,t)?.set??(d&&t in e?g=>e[t]=g:void 0)}var f,h=!1;i?[f,h]=Mf(()=>e[t]):f=e[t],f===void 0&&r!==void 0&&(f=c(),l&&(o&&hl(),l(f)));var m;if(o?m=()=>{var g=e[t];return g===void 0?c():(u=!0,g)}:m=()=>{var g=e[t];return g!==void 0&&(s=void 0),g===void 0?s:g},o&&(n&Sl)===0)return m;if(l){var _=e.$$legacy;return(function(g,R){return arguments.length>0?((!o||!R||_||h)&&l(R?m():g),g):m()})}var v=!1,b=((n&El)!==0?Pr:at)(()=>(v=!1,m()));i&&p(b);var y=O;return(function(g,R){if(arguments.length>0){const x=R?p(b):o&&i?un(g):g;return S(b,x),v=!0,s!==void 0&&(s=x),g}return Gt&&v||(y.f&Qe)!==0?b.v:p(b)})}function mu(e){q===null&&Ko(),pn&&q.l!==null?Lf(q).m.push(e):Io(()=>{const t=we(e);if(typeof t=="function")return t})}function kf(e){q===null&&Ko(),mu(()=>()=>we(e))}function Nf(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}function ti(){const e=q;return e===null&&Ko(),(t,n,r)=>{const o=e.s.$$events?.[t];if(o){const i=Sr(o)?o.slice():[o],a=Nf(t,n,r);for(const s of i)s.call(e.x,a);return!a.defaultPrevented}return!0}}function Lf(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Gf="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Gf);Ml();let ni=Float32Array;function ri(e,t,n){const r=new ni(3);return e&&(r[0]=e),t&&(r[1]=t),n&&(r[2]=n),r}function Uf(e,t,n){return n=n||new ni(3),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function Of(e,t,n){return n=n||new ni(3),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}let _u=Float32Array;function zf(e){return e=e||new _u(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Vf(e,t){t=t||new _u(16);const n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=e[9],f=e[10],h=e[11],m=e[12],_=e[13],v=e[14],b=e[15],y=f*b,g=v*h,R=u*b,x=v*c,T=u*h,F=f*c,B=o*b,E=v*i,A=o*h,I=f*i,W=o*c,te=u*i,pe=l*_,ge=m*d,Ie=a*_,$e=m*s,qe=a*d,Ye=l*s,yt=n*_,zt=m*r,Vt=n*d,Ht=l*r,Et=n*s,Rt=a*r,En=y*s+x*d+T*_-(g*s+R*d+F*_),Rn=g*r+B*d+I*_-(y*r+E*d+A*_),Xt=R*r+E*s+W*_-(x*r+B*s+te*_),Zn=F*r+A*s+te*d-(T*r+I*s+W*d),Z=1/(n*En+a*Rn+l*Xt+m*Zn);return t[0]=Z*En,t[1]=Z*Rn,t[2]=Z*Xt,t[3]=Z*Zn,t[4]=Z*(g*a+R*l+F*m-(y*a+x*l+T*m)),t[5]=Z*(y*n+E*l+A*m-(g*n+B*l+I*m)),t[6]=Z*(x*n+B*a+te*m-(R*n+E*a+W*m)),t[7]=Z*(T*n+I*a+W*l-(F*n+A*a+te*l)),t[8]=Z*(pe*c+$e*h+qe*b-(ge*c+Ie*h+Ye*b)),t[9]=Z*(ge*i+yt*h+Ht*b-(pe*i+zt*h+Vt*b)),t[10]=Z*(Ie*i+zt*c+Et*b-($e*i+yt*c+Rt*b)),t[11]=Z*(Ye*i+Vt*c+Rt*h-(qe*i+Ht*c+Et*h)),t[12]=Z*(Ie*f+Ye*v+ge*u-(qe*v+pe*u+$e*f)),t[13]=Z*(Vt*v+pe*o+zt*f-(yt*f+Ht*v+ge*o)),t[14]=Z*(yt*u+Rt*v+$e*o-(Et*v+Ie*o+zt*u)),t[15]=Z*(Et*f+qe*o+Ht*u-(Vt*u+Rt*f+Ye*o)),t}function Hf(e,t,n){n=n||ri();const r=t[0],o=t[1],i=t[2],a=r*e[3]+o*e[7]+i*e[11]+e[15];return n[0]=(r*e[0]+o*e[4]+i*e[8]+e[12])/a,n[1]=(r*e[1]+o*e[5]+i*e[9]+e[13])/a,n[2]=(r*e[2]+o*e[6]+i*e[10]+e[14])/a,n}function Xf(e,t,n){n=n||ri();const r=t[0],o=t[1],i=t[2];return n[0]=r*e[0]+o*e[4]+i*e[8],n[1]=r*e[1]+o*e[5]+i*e[9],n[2]=r*e[2]+o*e[6]+i*e[10],n}const oi=5120,$n=5121,ii=5122,si=5123,ai=5124,ui=5125,ci=5126,$f=32819,qf=32820,Yf=33635,Kf=5131,Wf=33640,jf=35899,Qf=35902,Zf=36269,Jf=34042,vu={};{const e=vu;e[oi]=Int8Array,e[$n]=Uint8Array,e[ii]=Int16Array,e[si]=Uint16Array,e[ai]=Int32Array,e[ui]=Uint32Array,e[ci]=Float32Array,e[$f]=Uint16Array,e[qf]=Uint16Array,e[Yf]=Uint16Array,e[Kf]=Uint16Array,e[Wf]=Uint32Array,e[jf]=Uint32Array,e[Qf]=Uint32Array,e[Zf]=Uint32Array,e[Jf]=Uint32Array}function Dr(e){if(e instanceof Int8Array)return oi;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return $n;if(e instanceof Int16Array)return ii;if(e instanceof Uint16Array)return si;if(e instanceof Int32Array)return ai;if(e instanceof Uint32Array)return ui;if(e instanceof Float32Array)return ci;throw new Error("unsupported typed array type")}function pu(e){if(e===Int8Array)return oi;if(e===Uint8Array||e===Uint8ClampedArray)return $n;if(e===Int16Array)return ii;if(e===Uint16Array)return si;if(e===Int32Array)return ai;if(e===Uint32Array)return ui;if(e===Float32Array)return ci;throw new Error("unsupported typed array type")}function bu(e){const t=vu[e];if(!t)throw new Error("unknown gl type");return t}const qn=typeof SharedArrayBuffer<"u"?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function ed(e,t,n){e.forEach(function(r){const o=t[r];o!==void 0&&(n[r]=o)})}function xu(...e){console.error(...e)}const as=new Map;function Mr(e,t){if(!e||typeof e!="object")return!1;let n=as.get(t);n||(n=new WeakMap,as.set(t,n));let r=n.get(e);if(r===void 0){const o=Object.prototype.toString.call(e);r=o.substring(8,o.length-1)===t,n.set(e,r)}return r}function td(e,t){return typeof WebGLBuffer<"u"&&Mr(t,"WebGLBuffer")}function gu(e,t){return typeof WebGLRenderbuffer<"u"&&Mr(t,"WebGLRenderbuffer")}function kr(e,t){return typeof WebGLTexture<"u"&&Mr(t,"WebGLTexture")}function nd(e,t){return typeof WebGLSampler<"u"&&Mr(t,"WebGLSampler")}const yu=35044,dt=34962,Eu=34963,rd=34660,od=5120,id=5121,sd=5122,ad=5123,ud=5124,cd=5125,Ru=5126,Su={attribPrefix:""};function ld(e,t,n,r,o){e.bindBuffer(t,n),e.bufferData(t,r,o||yu)}function li(e,t,n,r){if(td(e,t))return t;n=n||dt;const o=e.createBuffer();return ld(e,n,o,t,r),o}function Tu(e){return e==="indices"}function fd(e){return e===Int8Array||e===Uint8Array}function fi(e){return e.length?e:e.data}const dd=/coord|texture/i,hd=/color|colour/i;function md(e,t){let n;if(dd.test(e)?n=2:hd.test(e)?n=4:n=3,t%n>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${n} but ${t} values is not evenly divisible by ${n}. You should specify it.`);return n}function di(e,t,n){return e.numComponents||e.size||md(t,n||fi(e).length)}function Nr(e,t){if(qn(e))return e;if(qn(e.data))return e.data;Array.isArray(e)&&(e={data:e});let n=e.type?hi(e.type):void 0;return n||(Tu(t)?n=Uint16Array:n=Float32Array),new n(e.data)}function _d(e){return typeof e=="number"?e:e?pu(e):Ru}function hi(e){return typeof e=="number"?bu(e):e||Float32Array}function vd(e,t){return{buffer:t.buffer,numValues:24,type:_d(t.type),arrayType:hi(t.type)}}function pd(e,t){const n=t.data||t,r=hi(t.type),o=n*r.BYTES_PER_ELEMENT,i=e.createBuffer();return e.bindBuffer(dt,i),e.bufferData(dt,o,t.drawType||yu),{buffer:i,numValues:n,type:pu(r),arrayType:r}}function bd(e,t,n){const r=Nr(t,n);return{arrayType:r.constructor,buffer:li(e,r,void 0,t.drawType),type:Dr(r),numValues:0}}function xd(e,t){const n={};return Object.keys(t).forEach(function(r){if(!Tu(r)){const o=t[r],i=o.attrib||o.name||o.attribName||Su.attribPrefix+r;if(o.value){if(!Array.isArray(o.value)&&!qn(o.value))throw new Error("array.value is not array or typedarray");n[i]={value:o.value}}else{let a;o.buffer&&o.buffer instanceof WebGLBuffer?a=vd:typeof o=="number"||typeof o.data=="number"?a=pd:a=bd;const{buffer:s,type:u,numValues:c,arrayType:l}=a(e,o,r),d=o.normalize!==void 0?o.normalize:fd(l),f=di(o,r,c);n[i]={buffer:s,numComponents:f,type:u,normalize:d,stride:o.stride||0,offset:o.offset||0,divisor:o.divisor===void 0?void 0:o.divisor,drawType:o.drawType}}}}),e.bindBuffer(dt,null),n}function gd(e,t){return t===od||t===id?1:t===sd||t===ad?2:t===ud||t===cd||t===Ru?4:0}const ln=["position","positions","a_position"];function yd(e){let t,n;for(n=0;n<ln.length&&(t=ln[n],!(t in e));++n);n===ln.length&&(t=Object.keys(e)[0]);const r=e[t],o=fi(r).length;if(o===void 0)return 1;const i=di(r,t),a=o/i;if(o%i>0)throw new Error(`numComponents ${i} not correct for length ${o}`);return a}function Ed(e,t){let n,r;for(r=0;r<ln.length&&(n=ln[r],!(n in t||(n=Su.attribPrefix+n,n in t)));++r);r===ln.length&&(n=Object.keys(t)[0]);const o=t[n];if(!o.buffer)return 1;e.bindBuffer(dt,o.buffer);const i=e.getBufferParameter(dt,rd);e.bindBuffer(dt,null);const a=gd(e,o.type),s=i/a,u=o.numComponents||o.size,c=s/u;if(c%1!==0)throw new Error(`numComponents ${u} not correct for length ${length}`);return c}function Rd(e,t,n){const r=xd(e,t),o=Object.assign({},n||{});o.attribs=Object.assign({},n?n.attribs:{},r);const i=t.indices;if(i){const a=Nr(i,"indices");o.indices=li(e,a,Eu),o.numElements=a.length,o.elementType=Dr(a)}else o.numElements||(o.numElements=Ed(e,o.attribs));return o}function Sd(e,t,n){const r=n==="indices"?Eu:dt,o=Nr(t,n);return li(e,o,r)}function Td(e,t){const n={};return Object.keys(t).forEach(function(r){n[r]=Sd(e,t[r],r)}),t.indices?(n.numElements=t.indices.length,n.elementType=Dr(Nr(t.indices))):n.numElements=yd(t),n}const At=fi,Ad=di;function Au(e,t){let n=0;return e.push=function(){for(let r=0;r<arguments.length;++r){const o=arguments[r];if(o instanceof Array||qn(o))for(let i=0;i<o.length;++i)e[n++]=o[i];else e[n++]=o}},e.reset=function(r){n=r||0},e.numComponents=t,Object.defineProperty(e,"numElements",{get:function(){return this.length/this.numComponents|0}}),e}function k(e,t,n){const r=n||Float32Array;return Au(new r(e*t),e)}function Fd(e){return e!=="indices"}function wd(e){const t=e.indices,n={},r=t.length;function o(i){const a=e[i],s=a.numComponents,u=k(s,r,a.constructor);for(let c=0;c<r;++c){const d=t[c]*s;for(let f=0;f<s;++f)u.push(a[d+f])}n[i]=u}return Object.keys(e).filter(Fd).forEach(o),n}function Pd(e){if(e.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");const t=e.normal,n=t.length;for(let r=0;r<n;r+=9){const o=t[r+0],i=t[r+1],a=t[r+2],s=t[r+3],u=t[r+4],c=t[r+5],l=t[r+6],d=t[r+7],f=t[r+8];let h=o+s+l,m=i+u+d,_=a+c+f;const v=Math.sqrt(h*h+m*m+_*_);h/=v,m/=v,_/=v,t[r+0]=h,t[r+1]=m,t[r+2]=_,t[r+3]=h,t[r+4]=m,t[r+5]=_,t[r+6]=h,t[r+7]=m,t[r+8]=_}return e}function mi(e,t,n){const r=e.length,o=new Float32Array(3);for(let i=0;i<r;i+=3)n(t,[e[i],e[i+1],e[i+2]],o),e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2]}function Bd(e,t,n){n=n||ri();const r=t[0],o=t[1],i=t[2];return n[0]=r*e[0]+o*e[1]+i*e[2],n[1]=r*e[4]+o*e[5]+i*e[6],n[2]=r*e[8]+o*e[9]+i*e[10],n}function Fu(e,t){return mi(e,t,Xf),e}function wu(e,t){return mi(e,Vf(t),Bd),e}function Pu(e,t){return mi(e,t,Hf),e}function Bu(e,t){return Object.keys(e).forEach(function(n){const r=e[n];n.indexOf("pos")>=0?Pu(r,t):n.indexOf("tan")>=0||n.indexOf("binorm")>=0?Fu(r,t):n.indexOf("norm")>=0&&wu(r,t)}),e}function _i(e,t,n){return e=e||2,t=t||0,n=n||0,e*=.5,{position:{numComponents:2,data:[t+-1*e,n+-1*e,t+1*e,n+-1*e,t+-1*e,n+1*e,t+1*e,n+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function vi(e,t,n,r,o){e=e||1,t=t||1,n=n||1,r=r||1,o=o||zf();const i=(n+1)*(r+1),a=k(3,i),s=k(3,i),u=k(2,i);for(let f=0;f<=r;f++)for(let h=0;h<=n;h++){const m=h/n,_=f/r;a.push(e*m-e*.5,0,t*_-t*.5),s.push(0,1,0),u.push(m,_)}const c=n+1,l=k(3,n*r*2,Uint16Array);for(let f=0;f<r;f++)for(let h=0;h<n;h++)l.push((f+0)*c+h,(f+1)*c+h,(f+0)*c+h+1),l.push((f+1)*c+h,(f+1)*c+h+1,(f+0)*c+h+1);return Bu({position:a,normal:s,texcoord:u,indices:l},o)}function pi(e,t,n,r,o,i,a){if(t<=0||n<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");r=r||0,o=o||Math.PI,i=i||0,a=a||Math.PI*2;const s=o-r,u=a-i,c=(t+1)*(n+1),l=k(3,c),d=k(3,c),f=k(2,c);for(let _=0;_<=n;_++)for(let v=0;v<=t;v++){const b=v/t,y=_/n,g=u*b+i,R=s*y+r,x=Math.sin(g),T=Math.cos(g),F=Math.sin(R),B=Math.cos(R),E=T*F,A=B,I=x*F;l.push(e*E,e*A,e*I),d.push(E,A,I),f.push(1-b,y)}const h=t+1,m=k(3,t*n*2,Uint16Array);for(let _=0;_<t;_++)for(let v=0;v<n;v++)m.push((v+0)*h+_,(v+0)*h+_+1,(v+1)*h+_),m.push((v+1)*h+_,(v+0)*h+_+1,(v+1)*h+_+1);return{position:l,normal:d,texcoord:f,indices:m}}const Cd=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function bi(e){e=e||1;const t=e/2,n=[[-t,-t,-t],[+t,-t,-t],[-t,+t,-t],[+t,+t,-t],[-t,-t,+t],[+t,-t,+t],[-t,+t,+t],[+t,+t,+t]],r=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],o=[[1,0],[0,0],[0,1],[1,1]],i=24,a=k(3,i),s=k(3,i),u=k(2,i),c=k(3,12,Uint16Array);for(let l=0;l<6;++l){const d=Cd[l];for(let h=0;h<4;++h){const m=n[d[h]],_=r[l],v=o[h];a.push(m),s.push(_),u.push(v)}const f=4*l;c.push(f+0,f+1,f+2),c.push(f+0,f+2,f+3)}return{position:a,normal:s,texcoord:u,indices:c}}function Lr(e,t,n,r,o,i,a){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(o<1)throw new Error("verticalSubdivisions must be 1 or greater");const s=i===void 0?!0:i,u=a===void 0?!0:a,c=(s?2:0)+(u?2:0),l=(r+1)*(o+1+c),d=k(3,l),f=k(3,l),h=k(2,l),m=k(3,r*(o+c/2)*2,Uint16Array),_=r+1,v=Math.atan2(e-t,n),b=Math.cos(v),y=Math.sin(v),g=s?-2:0,R=o+(u?2:0);for(let x=g;x<=R;++x){let T=x/o,F=n*T,B;x<0?(F=0,T=1,B=e):x>o?(F=n,T=1,B=t):B=e+(t-e)*(x/o),(x===-2||x===o+2)&&(B=0,T=0),F-=n/2;for(let E=0;E<_;++E){const A=Math.sin(E*Math.PI*2/r),I=Math.cos(E*Math.PI*2/r);d.push(A*B,F,I*B),x<0?f.push(0,-1,0):x>o?f.push(0,1,0):B===0?f.push(0,0,0):f.push(A*b,y,I*b),h.push(E/r,1-T)}}for(let x=0;x<o+c;++x)if(!(x===1&&s||x===o+c-2&&u))for(let T=0;T<r;++T)m.push(_*(x+0)+0+T,_*(x+0)+1+T,_*(x+1)+1+T),m.push(_*(x+0)+0+T,_*(x+1)+1+T,_*(x+1)+0+T);return{position:d,normal:f,texcoord:h,indices:m}}function us(e,t){t=t||[];const n=[];for(let r=0;r<e.length;r+=4){const o=e[r],i=e.slice(r+1,r+4);i.push.apply(i,t);for(let a=0;a<o;++a)n.push.apply(n,i)}return n}function xi(){const e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],t=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],n=us([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),r=us([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),o=e.length/3,i={position:k(3,o),texcoord:k(2,o),normal:k(3,o),color:k(4,o,Uint8Array),indices:k(3,o/3,Uint16Array)};i.position.push(e),i.texcoord.push(t),i.normal.push(n),i.color.push(r);for(let a=0;a<o;++a)i.indices.push(a);return i}function Gr(e,t,n,r,o,i,a){if(o<=0)throw new Error("subdivisionDown must be > 0");i=i||0,a=a||1;const s=2,u=a-i,c=(o+1)*2*(2+s),l=k(3,c),d=k(3,c),f=k(2,c);function h(y,g,R){return y+(g-y)*R}function m(y,g,R,x,T,F){for(let B=0;B<=o;B++){const E=g/(s-1),A=B/o,I=(E-.5)*2,W=(i+A*u)*Math.PI,te=Math.sin(W),pe=Math.cos(W),ge=h(e,y,te),Ie=I*r,$e=pe*e,qe=te*ge;l.push(Ie,$e,qe);const Ye=Uf(Of([0,te,pe],R),x);d.push(Ye),f.push(E*T+F,A)}}for(let y=0;y<s;y++){const g=(y/(s-1)-.5)*2;m(t,y,[1,1,1],[0,0,0],1,0),m(t,y,[0,0,0],[g,0,0],0,0),m(n,y,[1,1,1],[0,0,0],1,0),m(n,y,[0,0,0],[g,0,0],0,1)}const _=k(3,o*2*(2+s),Uint16Array);function v(y,g){for(let R=0;R<o;++R)_.push(y+R+0,y+R+1,g+R+0),_.push(y+R+1,g+R+1,g+R+0)}const b=o+1;return v(b*0,b*4),v(b*5,b*7),v(b*6,b*2),v(b*3,b*1),{position:l,normal:d,texcoord:f,indices:_}}function gi(e,t,n,r,o,i){return Lr(e,e,t,n,r,o,i)}function yi(e,t,n,r,o,i){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(r<3)throw new Error("verticalSubdivisions must be 3 or greater");o=o||0,i=i||Math.PI*2;const a=i-o,s=n+1,u=r+1,c=s*u,l=k(3,c),d=k(3,c),f=k(2,c),h=k(3,n*r*2,Uint16Array);for(let m=0;m<u;++m){const _=m/r,v=_*Math.PI*2,b=Math.sin(v),y=e+b*t,g=Math.cos(v),R=g*t;for(let x=0;x<s;++x){const T=x/n,F=o+T*a,B=Math.sin(F),E=Math.cos(F),A=B*y,I=E*y,W=B*b,te=E*b;l.push(A,R,I),d.push(W,g,te),f.push(T,1-_)}}for(let m=0;m<r;++m)for(let _=0;_<n;++_){const v=1+_,b=1+m;h.push(s*m+_,s*b+_,s*m+v),h.push(s*b+_,s*b+v,s*m+v)}return{position:l,normal:d,texcoord:f,indices:h}}function Ei(e,t,n,r,o){if(t<3)throw new Error("divisions must be at least 3");n=n||1,o=o||1,r=r||0;const i=(t+1)*(n+1),a=k(3,i),s=k(3,i),u=k(2,i),c=k(3,n*t*2,Uint16Array);let l=0;const d=e-r,f=t+1;for(let h=0;h<=n;++h){const m=r+d*Math.pow(h/n,o);for(let _=0;_<=t;++_){const v=2*Math.PI*_/t,b=m*Math.cos(v),y=m*Math.sin(v);if(a.push(b,0,y),s.push(0,1,0),u.push(1-_/t,h/n),h>0&&_!==t){const g=l+(_+1),R=l+_,x=l+_-f,T=l+(_+1)-f;c.push(g,R,x),c.push(g,x,T)}}l+=t+1}return{position:a,normal:s,texcoord:u,indices:c}}function Id(e){return Math.random()*e|0}function Dd(e,t){t=t||{};const n=e.position.numElements,r=k(4,n,Uint8Array),o=t.rand||function(i,a){return a<3?Id(256):255};if(e.color=r,e.indices)for(let i=0;i<n;++i)r.push(o(i,0),o(i,1),o(i,2),o(i,3));else{const i=t.vertsPerColor||3,a=n/i;for(let s=0;s<a;++s){const u=[o(s,0),o(s,1),o(s,2),o(s,3)];for(let c=0;c<i;++c)r.push(u)}}return e}function He(e){return function(t){const n=e.apply(this,Array.prototype.slice.call(arguments,1));return Td(t,n)}}function Xe(e){return function(t){const n=e.apply(null,Array.prototype.slice.call(arguments,1));return Rd(t,n)}}const Md=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function Uo(e,t,n,r){r=r||0;const o=e.length;for(let i=0;i<o;++i)t[n+i]=e[i]+r}function Cu(e,t){const n=At(e),r=new n.constructor(t);let o=r;return n.numComponents&&n.numElements&&Au(r,n.numComponents),e.data&&(o={data:r},ed(Md,e,o)),o}function kd(e){const t={};let n;for(let s=0;s<e.length;++s){const u=e[s];Object.keys(u).forEach(function(c){t[c]||(t[c]=[]),!n&&c!=="indices"&&(n=c);const l=u[c],d=Ad(l,c),h=At(l).length/d;t[c].push(h)})}function r(s){let u=0,c;for(let l=0;l<e.length;++l){const f=e[l][s],h=At(f);u+=h.length,(!c||f.data)&&(c=f)}return{length:u,spec:c}}function o(s,u,c){let l=0,d=0;for(let f=0;f<e.length;++f){const m=e[f][s],_=At(m);s==="indices"?(Uo(_,c,d,l),l+=u[f]):Uo(_,c,d),d+=_.length}}const i=t[n],a={};return Object.keys(t).forEach(function(s){const u=r(s),c=Cu(u.spec,u.length);o(s,i,At(c)),a[s]=c}),a}function Nd(e){const t={};return Object.keys(e).forEach(function(n){const r=e[n],o=At(r),i=Cu(r,o.length);Uo(o,At(i),0),t[n]=i}),t}const Ld=Xe(xi),Gd=He(xi),Ud=Xe(bi),Od=He(bi),zd=Xe(vi),Vd=He(vi),Hd=Xe(pi),Xd=He(pi),$d=Xe(Lr),qd=He(Lr),Yd=Xe(_i),Kd=He(_i),Iu=Xe(Gr),Du=He(Gr),Wd=Xe(gi),jd=He(gi),Qd=Xe(yi),Zd=He(yi),Jd=Xe(Ei),e0=He(Ei),t0=Iu,n0=Du,r0=Gr;var Mu=Object.freeze({__proto__:null,create3DFBufferInfo:Ld,create3DFBuffers:Gd,create3DFVertices:xi,createAugmentedTypedArray:k,createCubeBufferInfo:Ud,createCubeBuffers:Od,createCubeVertices:bi,createPlaneBufferInfo:zd,createPlaneBuffers:Vd,createPlaneVertices:vi,createSphereBufferInfo:Hd,createSphereBuffers:Xd,createSphereVertices:pi,createTruncatedConeBufferInfo:$d,createTruncatedConeBuffers:qd,createTruncatedConeVertices:Lr,createXYQuadBufferInfo:Yd,createXYQuadBuffers:Kd,createXYQuadVertices:_i,createCresentBufferInfo:t0,createCresentBuffers:n0,createCresentVertices:r0,createCrescentBufferInfo:Iu,createCrescentBuffers:Du,createCrescentVertices:Gr,createCylinderBufferInfo:Wd,createCylinderBuffers:jd,createCylinderVertices:gi,createTorusBufferInfo:Qd,createTorusBuffers:Zd,createTorusVertices:yi,createDiscBufferInfo:Jd,createDiscBuffers:e0,createDiscVertices:Ei,deindexVertices:wd,flattenNormals:Pd,makeRandomVertexColors:Dd,reorientDirections:Fu,reorientNormals:wu,reorientPositions:Pu,reorientVertices:Bu,concatVertices:kd,duplicateVertices:Nd});function jn(e){return!!e.texStorage2D}const ku=(function(){const e={},t={};function n(r){const o=r.constructor.name;if(!e[o]){for(const i in r)if(typeof r[i]=="number"){const a=t[r[i]];t[r[i]]=a?`${a} | ${i}`:i}e[o]=!0}}return function(o,i){return n(o),t[i]||(typeof i=="number"?`0x${i.toString(16)}`:i)}})(),Dn=void 0,pt={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},_n=qn,Nu=(function(){let e;return function(){return e=e||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),e}})(),cs=6406,De=6407,Y=6408,ls=6409,fs=6410,Mn=6402,ds=34041,br=33071,yo=9728,Eo=9729,o0=9986,Ue=3553,Oe=34067,bt=32879,mt=35866,Ur=34069,i0=34070,s0=34071,a0=34072,u0=34073,c0=34074,xr=10241,gr=10240,yr=10242,Er=10243,hs=32882,l0=33082,f0=33083,d0=33084,h0=33085,m0=34892,_0=34893,Ri=3317,Lu=3314,Gu=32878,Uu=3316,Ou=3315,zu=32877,fr=37443,dr=37441,hr=37440,v0=33321,p0=36756,b0=33325,x0=33326,g0=33330,y0=33329,E0=33338,R0=33337,S0=33340,T0=33339,A0=33323,F0=36757,w0=33327,P0=33328,B0=33336,C0=33335,I0=33332,D0=33331,M0=33334,k0=33333,N0=32849,L0=35905,G0=36194,U0=36758,O0=35898,z0=35901,V0=34843,H0=34837,X0=36221,$0=36239,q0=36215,Y0=36233,K0=36209,W0=36227,j0=32856,Q0=35907,Z0=36759,J0=32855,eh=32854,th=32857,nh=34842,rh=34836,oh=36220,ih=36238,sh=36975,ah=36214,uh=36232,ch=36226,lh=36208,fh=33189,dh=33190,hh=36012,mh=36013,_h=35056,st=5120,$=5121,nr=5122,en=5123,rr=5124,St=5125,ae=5126,ms=32819,_s=32820,vs=33635,Se=5131,kn=36193,Ro=33640,vh=35899,ph=35902,bh=36269,xh=34042,or=33319,tn=33320,ir=6403,nn=36244,rn=36248,Tt=36249,ps=33776,bs=33777,xs=33778,gs=33779,ys=35916,Es=35917,Rs=35918,Ss=35919,Ts=36196,As=37488,Fs=37489,ws=37490,Ps=37491,Bs=37492,Cs=37493,Is=37494,Ds=37495,Ms=37496,ks=37497,Ns=35840,Ls=35841,Gs=35842,Us=35843,Os=37808,zs=37809,Vs=37810,Hs=37811,Xs=37812,$s=37813,qs=37814,Ys=37815,Ks=37816,Ws=37817,js=37818,Qs=37819,Zs=37820,Js=37821,ea=37840,ta=37841,na=37842,ra=37843,oa=37844,ia=37845,sa=37846,aa=37847,ua=37848,ca=37849,la=37850,fa=37851,da=37852,ha=37853,ma=36492,_a=36493,va=36494,pa=36495,ba=36283,xa=36284,ga=36285,ya=36286;let So;function gn(e){if(!So){const n={};n[cs]={textureFormat:cs,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[$,Se,kn,ae]},n[ls]={textureFormat:ls,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[$,Se,kn,ae]},n[fs]={textureFormat:fs,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[$,Se,kn,ae]},n[De]={textureFormat:De,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[$,Se,kn,ae,vs]},n[Y]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[$,Se,kn,ae,ms,_s]},n[Mn]={textureFormat:Mn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[St,en]},n[v0]={textureFormat:ir,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[$]},n[p0]={textureFormat:ir,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[st]},n[b0]={textureFormat:ir,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[ae,Se]},n[x0]={textureFormat:ir,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[ae]},n[g0]={textureFormat:nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[$]},n[y0]={textureFormat:nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[st]},n[I0]={textureFormat:nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[en]},n[D0]={textureFormat:nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[nr]},n[M0]={textureFormat:nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[St]},n[k0]={textureFormat:nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[rr]},n[A0]={textureFormat:or,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[$]},n[F0]={textureFormat:or,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[st]},n[w0]={textureFormat:or,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[ae,Se]},n[P0]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[ae]},n[B0]={textureFormat:tn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[$]},n[C0]={textureFormat:tn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[st]},n[E0]={textureFormat:tn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[en]},n[R0]={textureFormat:tn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[nr]},n[S0]={textureFormat:tn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[St]},n[T0]={textureFormat:tn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[rr]},n[N0]={textureFormat:De,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[$]},n[L0]={textureFormat:De,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[$]},n[G0]={textureFormat:De,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[$,vs]},n[U0]={textureFormat:De,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[st]},n[O0]={textureFormat:De,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ae,Se,vh]},n[z0]={textureFormat:De,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ae,Se,ph]},n[V0]={textureFormat:De,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[ae,Se]},n[H0]={textureFormat:De,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ae]},n[X0]={textureFormat:rn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[$]},n[$0]={textureFormat:rn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[st]},n[q0]={textureFormat:rn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[en]},n[Y0]={textureFormat:rn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[nr]},n[K0]={textureFormat:rn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[St]},n[W0]={textureFormat:rn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[rr]},n[j0]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[$]},n[Q0]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[$]},n[Z0]={textureFormat:Y,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[st]},n[J0]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[$,_s,Ro]},n[eh]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[$,ms]},n[th]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Ro]},n[nh]={textureFormat:Y,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[ae,Se]},n[rh]={textureFormat:Y,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[ae]},n[oh]={textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[$]},n[ih]={textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[st]},n[sh]={textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ro]},n[ah]={textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[en]},n[uh]={textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[nr]},n[ch]={textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[rr]},n[lh]={textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[St]},n[fh]={textureFormat:Mn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[en,St]},n[dh]={textureFormat:Mn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[St]},n[hh]={textureFormat:Mn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ae]},n[_h]={textureFormat:ds,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[xh]},n[mh]={textureFormat:ds,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[bh]},Object.keys(n).forEach(function(i){const a=n[i];a.bytesPerElementMap={},a.bytesPerElement.forEach(function(s,u){const c=a.type[u];a.bytesPerElementMap[c]=s})});const r={bytes:8,width:4,height:4},o={bytes:16,width:4,height:4};n[ps]={textureFormat:ps,colorRenderable:!1,textureFilterable:!0,block:r},n[bs]={textureFormat:bs,colorRenderable:!1,textureFilterable:!0,block:r},n[xs]={textureFormat:xs,colorRenderable:!1,textureFilterable:!0,block:o},n[gs]={textureFormat:gs,colorRenderable:!1,textureFilterable:!0,block:o},n[ys]={textureFormat:ys,colorRenderable:!1,textureFilterable:!0,block:r},n[Es]={textureFormat:Es,colorRenderable:!1,textureFilterable:!0,block:r},n[Rs]={textureFormat:Rs,colorRenderable:!1,textureFilterable:!0,block:o},n[Ss]={textureFormat:Ss,colorRenderable:!1,textureFilterable:!0,block:o},n[Ts]={textureFormat:Ts,colorRenderable:!1,textureFilterable:!0,block:r},n[As]={textureFormat:As,colorRenderable:!1,textureFilterable:!0,block:r},n[Fs]={textureFormat:Fs,colorRenderable:!1,textureFilterable:!0,block:r},n[ws]={textureFormat:ws,colorRenderable:!1,textureFilterable:!0,block:o},n[Ps]={textureFormat:Ps,colorRenderable:!1,textureFilterable:!0,block:o},n[Bs]={textureFormat:Bs,colorRenderable:!1,textureFilterable:!0,block:r},n[Cs]={textureFormat:Cs,colorRenderable:!1,textureFilterable:!0,block:r},n[Is]={textureFormat:Is,colorRenderable:!1,textureFilterable:!0,block:r},n[Ds]={textureFormat:Ds,colorRenderable:!1,textureFilterable:!0,block:r},n[Ms]={textureFormat:Ms,colorRenderable:!1,textureFilterable:!0,block:o},n[ks]={textureFormat:ks,colorRenderable:!1,textureFilterable:!0,block:o},n[Ns]={textureFormat:Ns,colorRenderable:!1,textureFilterable:!0,block:{bytes:32,width:8,height:8}},n[Ls]={textureFormat:Ls,colorRenderable:!1,textureFilterable:!0,block:{bytes:32,width:16,height:8}},n[Gs]={textureFormat:Gs,colorRenderable:!1,textureFilterable:!0,block:{bytes:32,width:8,height:8}},n[Us]={textureFormat:Us,colorRenderable:!1,textureFilterable:!0,block:{bytes:32,width:16,height:8}},n[Os]={textureFormat:Os,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:4,height:4}},n[zs]={textureFormat:zs,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:5,height:4}},n[Vs]={textureFormat:Vs,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:5,height:5}},n[Hs]={textureFormat:Hs,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:6,height:5}},n[Xs]={textureFormat:Xs,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:6,height:6}},n[$s]={textureFormat:$s,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:5}},n[qs]={textureFormat:qs,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:6}},n[Ys]={textureFormat:Ys,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:8}},n[Ks]={textureFormat:Ks,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:5}},n[Ws]={textureFormat:Ws,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:6}},n[js]={textureFormat:js,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:8}},n[Qs]={textureFormat:Qs,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:10}},n[Zs]={textureFormat:Zs,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:12,height:10}},n[Js]={textureFormat:Js,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:12,height:12}},n[ea]={textureFormat:ea,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:4,height:4}},n[ta]={textureFormat:ta,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:5,height:4}},n[na]={textureFormat:na,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:5,height:5}},n[ra]={textureFormat:ra,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:6,height:5}},n[oa]={textureFormat:oa,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:6,height:6}},n[ia]={textureFormat:ia,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:5}},n[sa]={textureFormat:sa,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:6}},n[aa]={textureFormat:aa,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:8}},n[ua]={textureFormat:ua,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:5}},n[ca]={textureFormat:ca,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:6}},n[la]={textureFormat:la,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:8}},n[fa]={textureFormat:fa,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:10}},n[da]={textureFormat:da,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:12,height:10}},n[ha]={textureFormat:ha,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:12,height:12}},n[ma]={textureFormat:ma,colorRenderable:!1,textureFilterable:!0,block:o},n[_a]={textureFormat:_a,colorRenderable:!1,textureFilterable:!0,block:o},n[va]={textureFormat:va,colorRenderable:!1,textureFilterable:!0,block:o},n[pa]={textureFormat:pa,colorRenderable:!1,textureFilterable:!0,block:o},n[ba]={textureFormat:ba,colorRenderable:!1,textureFilterable:!0,block:r},n[xa]={textureFormat:xa,colorRenderable:!1,textureFilterable:!0,block:r},n[ga]={textureFormat:ga,colorRenderable:!1,textureFilterable:!0,block:r},n[ya]={textureFormat:ya,colorRenderable:!1,textureFilterable:!0,block:r},So=n}const t=So[e];if(!t)throw new Error("unknown internal format");return t}function Vu(e,t){const r=gn(e).bytesPerElementMap[t];if(r===void 0)throw new Error("type not supported for internal format");return r}function yn(e){const t=gn(e);if(!t)throw new Error("unknown internal format");return{format:t.textureFormat,type:t.type?.[0]??$}}function Hu(e){return!!gn(e).block}function gh(e,t){const n=gn(e);return n.block?{blockWidth:n.block.width,blockHeight:n.block.height,bytesPerBlock:n.block.bytes}:{blockWidth:1,blockHeight:1,bytesPerBlock:Vu(e,t)}}function Ea(e){return(e&e-1)===0}function yh(e,t,n,r){if(!jn(e))return Ea(t)&&Ea(n);const o=gn(r);return o.colorRenderable&&o.textureFilterable}function To(e){return gn(e).textureFilterable}function Xu(e,t,n){return _n(t)?Dr(t):n||$}function sr(e,t,n,r,o){if(o%1!==0)throw new Error("can't guess dimensions");if(!n&&!r){const i=Math.sqrt(o/(t===Oe?6:1));i%1===0?(n=i,r=i):(n=o,r=1)}else if(r){if(!n&&(n=o/r,n%1))throw new Error("can't guess dimensions")}else if(r=o/n,r%1)throw new Error("can't guess dimensions");return{width:n,height:r}}function ut(e,t,n){let r,o,i;t.colorspaceConversion!==void 0&&(r=e.getParameter(fr),e.pixelStorei(fr,t.colorspaceConversion)),t.premultiplyAlpha!==void 0&&(o=e.getParameter(dr),e.pixelStorei(dr,t.premultiplyAlpha)),t.flipY!==void 0&&(i=e.getParameter(hr),e.pixelStorei(hr,t.flipY)),n(),r!==void 0&&e.pixelStorei(fr,r),o!==void 0&&e.pixelStorei(dr,o),i!==void 0&&e.pixelStorei(hr,i)}function Ao(e,t,n,r){const o=t[n];return{[n]:o===void 0?e.getParameter(r):o}}function Si(e,t){return{...t,...Ao(e,t,"flipY",hr),...Ao(e,t,"premultiplyAlpha",dr),...Ao(e,t,"colorspaceConversion",fr)}}function $u(e){e.pixelStorei(Ri,4),jn(e)&&(e.pixelStorei(Lu,0),e.pixelStorei(Gu,0),e.pixelStorei(Uu,0),e.pixelStorei(Ou,0),e.pixelStorei(zu,0))}function Eh(e,t,n,r){r.minMag&&(n.call(e,t,xr,r.minMag),n.call(e,t,gr,r.minMag)),r.min&&n.call(e,t,xr,r.min),r.mag&&n.call(e,t,gr,r.mag),r.wrap&&(n.call(e,t,yr,r.wrap),n.call(e,t,Er,r.wrap),(t===bt||nd(e,t))&&n.call(e,t,hs,r.wrap)),r.wrapR&&n.call(e,t,hs,r.wrapR),r.wrapS&&n.call(e,t,yr,r.wrapS),r.wrapT&&n.call(e,t,Er,r.wrapT),r.minLod!==void 0&&n.call(e,t,l0,r.minLod),r.maxLod!==void 0&&n.call(e,t,f0,r.maxLod),r.baseLevel!==void 0&&n.call(e,t,d0,r.baseLevel),r.maxLevel!==void 0&&n.call(e,t,h0,r.maxLevel),r.compareFunc!==void 0&&n.call(e,t,_0,r.compareFunc),r.compareMode!==void 0&&n.call(e,t,m0,r.compareMode)}function qu(e,t,n){const r=n.target||Ue;e.bindTexture(r,t),Eh(e,r,e.texParameteri,n)}function Rh(e){return e=e||pt.textureColor,_n(e)?e:new Uint8Array([e[0]*255,e[1]*255,e[2]*255,e[3]*255])}function Yu(e,t,{options:n,width:r,height:o,internalFormat:i,lastMipLevelUploaded:a}){n=n||pt.textureOptions,i=i||Y;const s=n.target||Ue;if(r=r||n.width,o=o||n.height,e.bindTexture(s,t),a>1){const u=Math.max(1,r>>a),c=Math.max(1,o>>a),l=u===1&&c===1,d=To(i)?Eo:yo,f=To(i)?l?o0:Eo:yo;e.texParameteri(s,gr,d),e.texParameteri(s,xr,f)}else if(yh(e,r,o,i))e.generateMipmap(s);else{const u=To(i)?Eo:yo;e.texParameteri(s,xr,u),e.texParameteri(s,gr,u),e.texParameteri(s,yr,br),e.texParameteri(s,Er,br)}}function Ra(e,t,n,r,o,i){Yu(e,t,{options:n,width:r,height:o,internalFormat:i})}function Yn(e){return e.auto===!0||e.auto===void 0&&e.level===void 0}function Oo(e,t){return t=t||{},t.cubeFaceOrder||[Ur,i0,s0,a0,u0,c0]}function zo(e,t){const r=Oo(e,t).map(function(o,i){return{face:o,ndx:i}});return r.sort(function(o,i){return o.face-i.face}),r}function Ku(e,t,n,r){r=r||pt.textureOptions;const o=r.target||Ue,i=r.level||0;let a=n.width,s=n.height;const u=r.internalFormat||r.format||Y,c=yn(u),l=r.format||c.format,d=r.type||c.type;if(e.bindTexture(o,t),o===Oe){const f=n.width,h=n.height;let m,_;if(f/6===h)m=h,_=[0,0,1,0,2,0,3,0,4,0,5,0];else if(h/6===f)m=f,_=[0,0,0,1,0,2,0,3,0,4,0,5];else if(f/3===h/2)m=f/3,_=[0,0,1,0,2,0,0,1,1,1,2,1];else if(f/2===h/3)m=f/2,_=[0,0,1,0,0,1,1,1,0,2,1,2];else throw new Error(`can't figure out cube map from element: ${n.src?n.src:n.nodeName}`);const v=Nu();v?(v.canvas.width=m,v.canvas.height=m,a=m,s=m,ut(e,r,()=>{zo(e,r).forEach(function(b){const y=_[b.ndx*2+0]*m,g=_[b.ndx*2+1]*m;v.drawImage(n,y,g,m,m,0,0,m,m),e.texImage2D(b.face,i,u,l,d,v.canvas)}),v.canvas.width=1,v.canvas.height=1})):typeof createImageBitmap<"u"&&(a=m,s=m,zo(e,r).forEach(function(b){const y=_[b.ndx*2+0]*m,g=_[b.ndx*2+1]*m;e.texImage2D(b.face,i,u,m,m,0,l,d,null),createImageBitmap(n,y,g,m,m,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(R){ut(e,r,()=>{e.bindTexture(o,t),e.texImage2D(b.face,i,u,l,d,R),Yn(r)&&Ra(e,t,r,a,s,u)})})}))}else o===bt||o===mt?ut(e,r,()=>{const f=Math.min(n.width,n.height),h=Math.max(n.width,n.height),m=h/f;if(m%1!==0)throw new Error("can not compute 3D dimensions of element");const _=n.width===h?1:0,v=n.height===h?1:0;e.pixelStorei(Ri,1),e.pixelStorei(Lu,n.width),e.pixelStorei(Gu,0),e.pixelStorei(zu,0),e.texImage3D(o,i,u,f,f,f,0,l,d,null);for(let b=0;b<m;++b){const y=b*f*_,g=b*f*v;e.pixelStorei(Uu,y),e.pixelStorei(Ou,g),e.texSubImage3D(o,i,0,0,b,f,f,1,l,d,n)}$u(e)}):ut(e,r,()=>{e.texImage2D(o,i,u,l,d,n)});Yn(r)&&Ra(e,t,r,a,s,u),qu(e,t,r)}function Qn(){}function Sh(e){if(typeof document<"u"){const t=document.createElement("a");return t.href=e,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}else{const t=new URL(location.href).origin;return new URL(e,location.href).origin===t}}function Th(e,t){return t===void 0&&!Sh(e)?"anonymous":t}function Ah(e,t,n){n=n||Qn;let r;if(t=t!==void 0?t:pt.crossOrigin,t=Th(e,t),typeof Image<"u"){r=new Image,t!==void 0&&(r.crossOrigin=t);const o=function(){r.removeEventListener("error",i),r.removeEventListener("load",a),r=null},i=function(){const u="couldn't load image: "+e;xu(u),n(u,r),o()},a=function(){n(null,r),o()};return r.addEventListener("error",i),r.addEventListener("load",a),r.src=e,r}else if(typeof ImageBitmap<"u"){let o,i;const a=function(){n(o,i)},s={};t&&(s.mode="cors"),fetch(e,s).then(function(u){if(!u.ok)throw u;return u.blob()}).then(function(u){return createImageBitmap(u,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(u){i=u,setTimeout(a)}).catch(function(u){o=u,setTimeout(a)}),r=null}return r}function Wu(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof ImageData<"u"&&e instanceof ImageData||typeof HTMLElement<"u"&&e instanceof HTMLElement}function Ti(e,t,n){return Wu(e)?(setTimeout(function(){n(null,e)}),e):Ah(e,t,n)}function Ai(e,t,n){n=n||pt.textureOptions;const r=n.target||Ue;if(e.bindTexture(r,t),n.color===!1)return;const o=Rh(n.color);if(r===Oe)for(let i=0;i<6;++i)e.texImage2D(Ur+i,0,Y,1,1,0,Y,$,o);else r===bt||r===mt?e.texImage3D(r,0,Y,1,1,1,0,Y,$,o):e.texImage2D(r,0,Y,1,1,0,Y,$,o)}function Fh(e,t,n,r){return r=r||Qn,n=n||pt.textureOptions,Ai(e,t,n),n=Si(e,n),Ti(n.src,n.crossOrigin,function(i,a){i?r(i,t,a):(Ku(e,t,a,n),r(null,t,a))})}function wh(e,t,n,r){r=r||Qn;const o=n.src;if(o.length!==6)throw new Error("there must be 6 urls for a cubemap");const i=n.level||0,a=n.internalFormat||n.format||Y,s=yn(a),u=n.format||s.format,c=n.type||$,l=n.target||Ue;if(l!==Oe)throw new Error("target must be TEXTURE_CUBE_MAP");Ai(e,t,n),n=Si(e,n);let d=6;const f=[],h=Oo(e,n);let m;function _(v){return function(b,y){--d,b?f.push(b):y.width!==y.height?f.push("cubemap face img is not a square: "+y.src):ut(e,n,()=>{e.bindTexture(l,t),d===5?Oo().forEach(function(g){e.texImage2D(g,i,a,u,c,y)}):e.texImage2D(v,i,a,u,c,y),Yn(n)&&e.generateMipmap(l)}),d===0&&r(f.length?f:void 0,t,m)}}m=o.map(function(v,b){return Ti(v,n.crossOrigin,_(h[b]))})}function Ph(e,t,n,r){r=r||Qn;const o=n.src,i=n.internalFormat||n.format||Y,a=yn(i),s=n.format||a.format,u=n.type||$,c=n.target||mt;if(c!==bt&&c!==mt)throw new Error("target must be TEXTURE_3D or TEXTURE_2D_ARRAY");Ai(e,t,n),n=Si(e,n);let l=o.length;const d=[];let f;const h=n.level||0;let m=n.width,_=n.height;const v=o.length;let b=!0;function y(g){return function(R,x){--l,R?d.push(R):ut(e,n,()=>{if(e.bindTexture(c,t),b){b=!1,m=n.width||x.width,_=n.height||x.height,e.texImage3D(c,h,i,m,_,v,0,s,u,null);for(let T=0;T<v;++T)e.texSubImage3D(c,h,0,0,T,m,_,1,s,u,x)}else{let T=x,F;(x.width!==m||x.height!==_)&&(F=Nu(),T=F.canvas,F.canvas.width=m,F.canvas.height=_,F.drawImage(x,0,0,m,_)),e.texSubImage3D(c,h,0,0,g,m,_,1,s,u,T),F&&T===F.canvas&&(F.canvas.width=0,F.canvas.height=0)}Yn(n)&&e.generateMipmap(c)}),l===0&&r(d.length?d:void 0,t,f)}}f=o.map(function(g,R){return Ti(g,n.crossOrigin,y(R))})}function Bh(e,t,n,r){r=r||pt.textureOptions;const o=r.target||Ue;e.bindTexture(o,t);const i=r.level||0,a=r.internalFormat||r.format||Y,s=yn(a),u=r.format||s.format,c=r.type||Xu(e,n,s.type);if(_n(n))n instanceof Uint8ClampedArray&&(n=new Uint8Array(n.buffer));else{const _=bu(c);n=new _(n)}const{width:l,height:d,depth:f}=Ch(o,n,r,a,u,c),h=Hu(a);$u(e),e.pixelStorei(Ri,r.unpackAlignment||1);let m=0;return ut(e,r,()=>{let _=0;const{blockWidth:v,blockHeight:b,bytesPerBlock:y}=gh(a,c);for(;_<n.byteLength;){const g=Math.max(1,l>>m),R=Math.max(1,d>>m),x=o===Ue?Math.max(1,f>>m):f,T=Math.ceil(g/v),F=Math.ceil(R/b),B=o===Oe?6:1,E=T*F*y*x*B;if(_+E>n.byteLength)throw new Error("src size does not match number of mip levels");const A=n.subarray(_/n.BYTES_PER_ELEMENT,(_+E)/n.BYTES_PER_ELEMENT),I=i+m;if(o===Oe){const W=A.length/6;zo(e,r).forEach(te=>{const pe=W*te.ndx,ge=A.subarray(pe,pe+W);h?e.compressedTexImage2D(te.face,I,a,g,R,0,ge):e.texImage2D(te.face,I,a,g,R,0,u,c,ge)})}else o===bt||o===mt?e.texImage3D(o,I,a,g,R,x,0,u,c,A):h?e.compressedTexImage2D(o,I,a,g,R,0,A):e.texImage2D(o,I,a,g,R,0,u,c,A);if(++m,_+=E,g===1&&R===1&&x===1&&_!==n.byteLength)throw new Error("src size has more data than can fit in mip levels")}}),{width:l,height:d,depth:f,type:c,lastMipLevelUploaded:i+m-1}}function Ch(e,t,n,r,o,i){let a=n.width,s=n.height,u=n.depth;const c=Hu(r);if(c){if(!a||!s)throw new Error("compressed texture needs to set width and height!");u=u||1}else{const l=Vu(r,i),d=t.byteLength/l;if(d%1)throw new Error(`length wrong size for format: ${ku(Dn,o)}`);if(c&&(!a||!s))throw new Error("compressed texture needs to set width and height!");let f;if(e===bt||e===mt)if(!a&&!s&&!u){const h=Math.cbrt(d);if(h%1!==0)throw new Error(`can't guess cube size of array of numElements: ${d}`);a=h,s=h,u=h}else a&&(!s||!u)?(f=sr(Dn,e,s,u,d/a),s=f.width,u=f.height):s&&(!a||!u)?(f=sr(Dn,e,a,u,d/s),a=f.width,u=f.height):(f=sr(Dn,e,a,s,d/u),a=f.width,s=f.height);else f=sr(Dn,e,a,s,d),a=f.width,s=f.height}return{width:a,height:s,depth:u}}function Ih(e,t,n){const r=n.target||Ue;e.bindTexture(r,t);const o=n.level||0,i=n.internalFormat||n.format||Y,a=yn(i),s=n.format||a.format,u=n.type||a.type;ut(e,n,()=>{if(r===Oe)for(let c=0;c<6;++c)e.texImage2D(Ur+c,o,i,n.width,n.height,0,s,u,null);else r===bt||r===mt?e.texImage3D(r,o,i,n.width,n.height,n.depth,0,s,u,null):e.texImage2D(r,o,i,n.width,n.height,0,s,u,null)})}function ju(e,t,n){n=n||Qn,t=t||pt.textureOptions;const r=e.createTexture(),o=t.target||Ue;let i=t.width||1,a=t.height||1,s=0;const u=t.internalFormat||Y;e.bindTexture(o,r),o===Oe&&(e.texParameteri(o,yr,br),e.texParameteri(o,Er,br));let c=t.src;if(c)if(typeof c=="function"&&(c=c(e,t)),typeof c=="string")Fh(e,r,t,n);else if(_n(c)||Array.isArray(c)&&(typeof c[0]=="number"||Array.isArray(c[0])||_n(c[0]))){const l=Bh(e,r,c,t);i=l.width,a=l.height,s=l.lastMipLevelUploaded}else Array.isArray(c)&&(typeof c[0]=="string"||Wu(c[0]))?o===Oe?wh(e,r,t,n):Ph(e,r,t,n):(Ku(e,r,c,t),i=c.width,a=c.height);else Ih(e,r,t);return Yn(t)&&Yu(e,r,{options:t,width:i,height:a,internalFormat:u,lastMipLevelUploaded:s}),qu(e,r,t),r}function Qu(e,t,n,r,o,i){r=r||n.width,o=o||n.height,i=i||n.depth;const a=n.target||Ue;e.bindTexture(a,t);const s=n.level||0,u=n.internalFormat||n.format||Y,c=yn(u),l=n.format||c.format;let d;const f=n.src;if(f&&(_n(f)||Array.isArray(f)&&typeof f[0]=="number")?d=n.type||Xu(e,f,c.type):d=n.type||c.type,a===Oe)for(let h=0;h<6;++h)e.texImage2D(Ur+h,s,u,r,o,0,l,d,null);else a===bt||a===mt?e.texImage3D(a,s,u,r,o,i,0,l,d,null):e.texImage2D(a,s,u,r,o,0,l,d,null)}const Fi=xu;function Zu(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}const Rr=33984,Or=34962,Dh=34963,Mh=35713,kh=35714,Nh=35632,Lh=35633,Gh=35981,Ju=35718,Uh=35721,Oh=35971,zh=35382,Vh=35396,Hh=35398,Xh=35392,$h=35395,zr=5126,ec=35664,tc=35665,nc=35666,wi=5124,rc=35667,oc=35668,ic=35669,sc=35670,ac=35671,uc=35672,cc=35673,lc=35674,fc=35675,dc=35676,qh=35678,Yh=35680,Kh=35679,Wh=35682,jh=35685,Qh=35686,Zh=35687,Jh=35688,em=35689,tm=35690,nm=36289,rm=36292,om=36293,Pi=5125,hc=36294,mc=36295,_c=36296,im=36298,sm=36299,am=36300,um=36303,cm=36306,lm=36307,fm=36308,dm=36311,Vr=3553,Hr=34067,Bi=32879,Xr=35866,C={};function vc(e,t){return C[t].bindPoint}function hm(e,t){return function(n){e.uniform1f(t,n)}}function mm(e,t){return function(n){e.uniform1fv(t,n)}}function _m(e,t){return function(n){e.uniform2fv(t,n)}}function vm(e,t){return function(n){e.uniform3fv(t,n)}}function pm(e,t){return function(n){e.uniform4fv(t,n)}}function pc(e,t){return function(n){e.uniform1i(t,n)}}function bc(e,t){return function(n){e.uniform1iv(t,n)}}function xc(e,t){return function(n){e.uniform2iv(t,n)}}function gc(e,t){return function(n){e.uniform3iv(t,n)}}function yc(e,t){return function(n){e.uniform4iv(t,n)}}function bm(e,t){return function(n){e.uniform1ui(t,n)}}function xm(e,t){return function(n){e.uniform1uiv(t,n)}}function gm(e,t){return function(n){e.uniform2uiv(t,n)}}function ym(e,t){return function(n){e.uniform3uiv(t,n)}}function Em(e,t){return function(n){e.uniform4uiv(t,n)}}function Rm(e,t){return function(n){e.uniformMatrix2fv(t,!1,n)}}function Sm(e,t){return function(n){e.uniformMatrix3fv(t,!1,n)}}function Tm(e,t){return function(n){e.uniformMatrix4fv(t,!1,n)}}function Am(e,t){return function(n){e.uniformMatrix2x3fv(t,!1,n)}}function Fm(e,t){return function(n){e.uniformMatrix3x2fv(t,!1,n)}}function wm(e,t){return function(n){e.uniformMatrix2x4fv(t,!1,n)}}function Pm(e,t){return function(n){e.uniformMatrix4x2fv(t,!1,n)}}function Bm(e,t){return function(n){e.uniformMatrix3x4fv(t,!1,n)}}function Cm(e,t){return function(n){e.uniformMatrix4x3fv(t,!1,n)}}function le(e,t,n,r){const o=vc(e,t);return jn(e)?function(i){let a,s;!i||kr(e,i)?(a=i,s=null):(a=i.texture,s=i.sampler),e.uniform1i(r,n),e.activeTexture(Rr+n),e.bindTexture(o,a),e.bindSampler(n,s)}:function(i){e.uniform1i(r,n),e.activeTexture(Rr+n),e.bindTexture(o,i)}}function fe(e,t,n,r,o){const i=vc(e,t),a=new Int32Array(o);for(let s=0;s<o;++s)a[s]=n+s;return jn(e)?function(s){e.uniform1iv(r,a),s.forEach(function(u,c){e.activeTexture(Rr+a[c]);let l,d;!u||kr(e,u)?(l=u,d=null):(l=u.texture,d=u.sampler),e.bindSampler(n,d),e.bindTexture(i,l)})}:function(s){e.uniform1iv(r,a),s.forEach(function(u,c){e.activeTexture(Rr+a[c]),e.bindTexture(i,u)})}}C[zr]={Type:Float32Array,size:4,setter:hm,arraySetter:mm};C[ec]={Type:Float32Array,size:8,setter:_m,cols:2};C[tc]={Type:Float32Array,size:12,setter:vm,cols:3};C[nc]={Type:Float32Array,size:16,setter:pm,cols:4};C[wi]={Type:Int32Array,size:4,setter:pc,arraySetter:bc};C[rc]={Type:Int32Array,size:8,setter:xc,cols:2};C[oc]={Type:Int32Array,size:12,setter:gc,cols:3};C[ic]={Type:Int32Array,size:16,setter:yc,cols:4};C[Pi]={Type:Uint32Array,size:4,setter:bm,arraySetter:xm};C[hc]={Type:Uint32Array,size:8,setter:gm,cols:2};C[mc]={Type:Uint32Array,size:12,setter:ym,cols:3};C[_c]={Type:Uint32Array,size:16,setter:Em,cols:4};C[sc]={Type:Uint32Array,size:4,setter:pc,arraySetter:bc};C[ac]={Type:Uint32Array,size:8,setter:xc,cols:2};C[uc]={Type:Uint32Array,size:12,setter:gc,cols:3};C[cc]={Type:Uint32Array,size:16,setter:yc,cols:4};C[lc]={Type:Float32Array,size:32,setter:Rm,rows:2,cols:2};C[fc]={Type:Float32Array,size:48,setter:Sm,rows:3,cols:3};C[dc]={Type:Float32Array,size:64,setter:Tm,rows:4,cols:4};C[jh]={Type:Float32Array,size:32,setter:Am,rows:2,cols:3};C[Qh]={Type:Float32Array,size:32,setter:wm,rows:2,cols:4};C[Zh]={Type:Float32Array,size:48,setter:Fm,rows:3,cols:2};C[Jh]={Type:Float32Array,size:48,setter:Bm,rows:3,cols:4};C[em]={Type:Float32Array,size:64,setter:Pm,rows:4,cols:2};C[tm]={Type:Float32Array,size:64,setter:Cm,rows:4,cols:3};C[qh]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Vr};C[Yh]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Hr};C[Kh]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Bi};C[Wh]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Vr};C[nm]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Xr};C[rm]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Xr};C[om]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Hr};C[im]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Vr};C[sm]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Bi};C[am]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Hr};C[um]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Xr};C[cm]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Vr};C[lm]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Bi};C[fm]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Hr};C[dm]={Type:null,size:0,setter:le,arraySetter:fe,bindPoint:Xr};function $r(e,t){return function(n){if(n.value)switch(e.disableVertexAttribArray(t),n.value.length){case 4:e.vertexAttrib4fv(t,n.value);break;case 3:e.vertexAttrib3fv(t,n.value);break;case 2:e.vertexAttrib2fv(t,n.value);break;case 1:e.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(Or,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents||n.size,n.type||zr,n.normalize||!1,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function xt(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4iv(t,n.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(Or,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||wi,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function qr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4uiv(t,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(Or,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||Pi,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Ci(e,t,n){const r=n.size,o=n.count;return function(i){e.bindBuffer(Or,i.buffer);const a=i.size||i.numComponents||r,s=a/o,u=i.type||zr,l=C[u].size*a,d=i.normalize||!1,f=i.offset||0,h=l/o;for(let m=0;m<o;++m)e.enableVertexAttribArray(t+m),e.vertexAttribPointer(t+m,s,u,d,l,f+h*m),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+m,i.divisor||0)}}const Q={};Q[zr]={size:4,setter:$r};Q[ec]={size:8,setter:$r};Q[tc]={size:12,setter:$r};Q[nc]={size:16,setter:$r};Q[wi]={size:4,setter:xt};Q[rc]={size:8,setter:xt};Q[oc]={size:12,setter:xt};Q[ic]={size:16,setter:xt};Q[Pi]={size:4,setter:qr};Q[hc]={size:8,setter:qr};Q[mc]={size:12,setter:qr};Q[_c]={size:16,setter:qr};Q[sc]={size:4,setter:xt};Q[ac]={size:8,setter:xt};Q[uc]={size:12,setter:xt};Q[cc]={size:16,setter:xt};Q[lc]={size:4,setter:Ci,count:2};Q[fc]={size:9,setter:Ci,count:3};Q[dc]={size:16,setter:Ci,count:4};const Im=/ERROR:\s*\d+:(\d+)/gi;function Dm(e,t="",n=0){const r=[...t.matchAll(Im)],o=new Map(r.map((i,a)=>{const s=parseInt(i[1]),u=r[a+1],c=u?u.index:t.length,l=t.substring(i.index,c);return[s-1,l]}));return e.split(`
`).map((i,a)=>{const s=o.get(a);return`${a+1+n}: ${i}${s?`

^^^ ${s}`:""}`}).join(`
`)}const Sa=/^[ \t]*\n/;function Ec(e){let t=0;return Sa.test(e)&&(t=1,e=e.replace(Sa,"")),{lineOffset:t,shaderSource:e}}function Mm(e,t){return e.errorCallback(t),e.callback&&setTimeout(()=>{e.callback(`${t}
${e.errors.join(`
`)}`)}),null}function km(e,t,n,r){if(r=r||Fi,!e.getShaderParameter(n,Mh)){const i=e.getShaderInfoLog(n),{lineOffset:a,shaderSource:s}=Ec(e.getShaderSource(n)),u=`${Dm(s,i,a)}
Error compiling ${ku(e,t)}: ${i}`;return r(u),u}return""}function Ii(e,t,n){let r,o,i;if(typeof t=="function"&&(n=t,t=void 0),typeof e=="function")n=e,e=void 0;else if(e&&!Array.isArray(e)){const c=e;n=c.errorCallback,e=c.attribLocations,r=c.transformFeedbackVaryings,o=c.transformFeedbackMode,i=c.callback}const a=n||Fi,s=[],u={errorCallback(c,...l){s.push(c),a(c,...l)},transformFeedbackVaryings:r,transformFeedbackMode:o,callback:i,errors:s};{let c={};Array.isArray(e)?e.forEach(function(l,d){c[l]=t?t[d]:d}):c=e||{},u.attribLocations=c}return u}const Nm=["VERTEX_SHADER","FRAGMENT_SHADER"];function Lm(e,t){if(t.indexOf("frag")>=0)return Nh;if(t.indexOf("vert")>=0)return Lh}function Gm(e,t,n){const r=e.getAttachedShaders(t);for(const o of r)n.has(o)||e.deleteShader(o);e.deleteProgram(t)}const Um=(e=0)=>new Promise(t=>setTimeout(t,e));function Om(e,t,n){const r=e.createProgram(),{attribLocations:o,transformFeedbackVaryings:i,transformFeedbackMode:a}=Ii(n);for(let s=0;s<t.length;++s){let u=t[s];if(typeof u=="string"){const c=Zu(u),l=c?c.text:u;let d=e[Nm[s]];c&&c.type&&(d=Lm(e,c.type)||d),u=e.createShader(d),e.shaderSource(u,Ec(l).shaderSource),e.compileShader(u)}e.attachShader(r,u)}Object.entries(o).forEach(([s,u])=>e.bindAttribLocation(r,u,s));{let s=i;s&&(s.attribs&&(s=s.attribs),Array.isArray(s)||(s=Object.keys(s)),e.transformFeedbackVaryings(r,s,a||Gh))}return e.linkProgram(r),r}function zm(e,t,n,r,o){const i=Ii(n,r,o),a=new Set(t),s=Om(e,t,i);function u(c,l){const d=Hm(c,l,i.errorCallback);return d&&Gm(c,l,a),d}if(i.callback){Vm(e,s).then(()=>{const c=u(e,s);i.callback(c,c?void 0:s)});return}return u(e,s)?void 0:s}async function Vm(e,t){const n=e.getExtension("KHR_parallel_shader_compile"),r=n?(i,a)=>i.getProgramParameter(a,n.COMPLETION_STATUS_KHR):()=>!0;let o=0;do await Um(o),o=1e3/60;while(!r(e,t))}function Hm(e,t,n){if(n=n||Fi,!e.getProgramParameter(t,kh)){const o=e.getProgramInfoLog(t);n(`Error in program linking: ${o}`);const a=e.getAttachedShaders(t).map(s=>km(e,e.getShaderParameter(s,e.SHADER_TYPE),s,n));return`${o}
${a.filter(s=>s).join(`
`)}`}}function Xm(e,t,n,r,o){return zm(e,t,n,r,o)}function Rc(e){const t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const $m=/(\.|\[|]|\w+)/g,qm=e=>e>="0"&&e<="9";function Ym(e,t,n,r){const o=e.split($m).filter(s=>s!=="");let i=0,a="";for(;;){const s=o[i++];a+=s;const u=qm(s[0]),c=u?parseInt(s):s;if(u&&(a+=o[i++]),i===o.length){n[c]=t;break}else{const d=o[i++],f=d==="[",h=n[c]||(f?[]:{});n[c]=h,n=h,r[a]=r[a]||(function(m){return function(_){Sc(m,_)}})(h),a+=d}}}function Km(e,t){let n=0;function r(s,u,c){const l=u.name.endsWith("[0]"),d=u.type,f=C[d];if(!f)throw new Error(`unknown type: 0x${d.toString(16)}`);let h;if(f.bindPoint){const m=n;n+=u.size,l?h=f.arraySetter(e,d,m,c,u.size):h=f.setter(e,d,m,c,u.size)}else f.arraySetter&&l?h=f.arraySetter(e,c):h=f.setter(e,c);return h.location=c,h}const o={},i={},a=e.getProgramParameter(t,Ju);for(let s=0;s<a;++s){const u=e.getActiveUniform(t,s);if(Rc(u))continue;let c=u.name;c.endsWith("[0]")&&(c=c.substr(0,c.length-3));const l=e.getUniformLocation(t,u.name);if(l){const d=r(t,u,l);o[c]=d,Ym(c,d,i,o)}}return o}function Wm(e,t){const n={},r=e.getProgramParameter(t,Oh);for(let o=0;o<r;++o){const i=e.getTransformFeedbackVarying(t,o);n[i.name]={index:o,type:i.type,size:i.size}}return n}function jm(e,t){const n=e.getProgramParameter(t,Ju),r=[],o=[];for(let s=0;s<n;++s){o.push(s),r.push({});const u=e.getActiveUniform(t,s);r[s].name=u.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(s){const u=s[0],c=s[1];e.getActiveUniforms(t,o,e[u]).forEach(function(l,d){r[d][c]=l})});const i={},a=e.getProgramParameter(t,zh);for(let s=0;s<a;++s){const u=e.getActiveUniformBlockName(t,s),c={index:e.getUniformBlockIndex(t,u),usedByVertexShader:e.getActiveUniformBlockParameter(t,s,Vh),usedByFragmentShader:e.getActiveUniformBlockParameter(t,s,Hh),size:e.getActiveUniformBlockParameter(t,s,Xh),uniformIndices:e.getActiveUniformBlockParameter(t,s,$h)};c.used=c.usedByVertexShader||c.usedByFragmentShader,i[u]=c}return{blockSpecs:i,uniformData:r}}function Sc(e,t){for(const n in t){const r=e[n];typeof r=="function"?r(t[n]):Sc(e[n],t[n])}}function Di(e,...t){const n=e.uniformSetters||e,r=t.length;for(let o=0;o<r;++o){const i=t[o];if(Array.isArray(i)){const a=i.length;for(let s=0;s<a;++s)Di(n,i[s])}else for(const a in i){const s=n[a];s&&s(i[a])}}}function Qm(e,t){const n={},r=e.getProgramParameter(t,Uh);for(let o=0;o<r;++o){const i=e.getActiveAttrib(t,o);if(Rc(i))continue;const a=e.getAttribLocation(t,i.name),s=Q[i.type],u=s.setter(e,a,s);u.location=a,n[i.name]=u}return n}function Zm(e,t){for(const n in t){const r=e[n];r&&r(t[n])}}function Tc(e,t,n){n.vertexArrayObject?e.bindVertexArray(n.vertexArrayObject):(Zm(t.attribSetters||t,n.attribs),n.indices&&e.bindBuffer(Dh,n.indices))}function Ta(e,t){const n=Km(e,t),r=Qm(e,t),o={program:t,uniformSetters:n,attribSetters:r,uniformLocations:Object.fromEntries(Object.entries(n).map(([i,a])=>[i,a.location])),attribLocations:Object.fromEntries(Object.entries(r).map(([i,a])=>[i,a.location]))};return jn(e)&&(o.uniformBlockSpec=jm(e,t),o.transformFeedbackInfo=Wm(e,t)),o}const Jm=/\s|{|}|;/;function e_(e,t,n,r,o){const i=Ii(n,r,o),a=[];if(t=t.map(function(c){if(!Jm.test(c)){const l=Zu(c);if(l)c=l.text;else{const d=`no element with id: ${c}`;i.errorCallback(d),a.push(d)}}return c}),a.length)return Mm(i,"");const s=i.callback;s&&(i.callback=(c,l)=>{s(c,c?void 0:Ta(e,l))});const u=Xm(e,t,i);return u?Ta(e,u):null}const t_=4,Aa=5123;function Ac(e,t,n,r,o,i){n=n===void 0?t_:n;const a=t.indices,s=t.elementType,u=r===void 0?t.numElements:r;o=o===void 0?0:o,s||a?i!==void 0?e.drawElementsInstanced(n,u,s===void 0?Aa:t.elementType,o,i):e.drawElements(n,u,s===void 0?Aa:t.elementType,o):i!==void 0?e.drawArraysInstanced(n,o,u,i):e.drawArrays(n,o,u)}const Fc=36160,Ft=36161,n_=3553,r_=5121,o_=6402,i_=6408,s_=33190,a_=36012,u_=35056,c_=36013,l_=32854,f_=32855,d_=36194,wc=33189,Pc=6401,Bc=36168,Mi=34041,Vo=36064,Yr=36096,Cc=36128,ki=33306,Ho=33071,Xo=9729,Ic=[{format:i_,type:r_,min:Xo,wrap:Ho},{format:Mi}],Be={};Be[Mi]=ki;Be[Pc]=Cc;Be[Bc]=Cc;Be[o_]=Yr;Be[wc]=Yr;Be[s_]=Yr;Be[a_]=Yr;Be[u_]=ki;Be[c_]=ki;function h_(e,t){return Be[e]||Be[t]}const gt={};gt[l_]=!0;gt[f_]=!0;gt[d_]=!0;gt[Mi]=!0;gt[wc]=!0;gt[Pc]=!0;gt[Bc]=!0;function m_(e){return gt[e]}const __=32;function v_(e){return e>=Vo&&e<Vo+__}function p_(e,t,n,r){const o=Fc,i=e.createFramebuffer();e.bindFramebuffer(o,i),n=n||e.drawingBufferWidth,r=r||e.drawingBufferHeight,t=t||Ic;const a=[],s={framebuffer:i,attachments:[],width:n,height:r};return t.forEach(function(u,c){let l=u.attachment;const d=u.samples,f=u.format;let h=u.attachmentPoint||h_(f,u.internalFormat);if(h||(h=Vo+c),v_(h)&&a.push(h),!l)if(d!==void 0||m_(f))l=e.createRenderbuffer(),e.bindRenderbuffer(Ft,l),d>1?e.renderbufferStorageMultisample(Ft,d,f,n,r):e.renderbufferStorage(Ft,f,n,r);else{const m=Object.assign({},u);m.width=n,m.height=r,m.auto===void 0&&(m.auto=!1,m.min=m.min||m.minMag||Xo,m.mag=m.mag||m.minMag||Xo,m.wrapS=m.wrapS||m.wrap||Ho,m.wrapT=m.wrapT||m.wrap||Ho),l=ju(e,m)}if(gu(e,l))e.framebufferRenderbuffer(o,h,Ft,l);else if(kr(e,l))u.layer!==void 0?e.framebufferTextureLayer(o,h,l,u.level||0,u.layer):e.framebufferTexture2D(o,h,u.target||n_,l,u.level||0);else throw new Error("unknown attachment type");s.attachments.push(l)}),e.drawBuffers&&e.drawBuffers(a),s}function b_(e,t,n,r,o){r=r||e.drawingBufferWidth,o=o||e.drawingBufferHeight,t.width=r,t.height=o,n=n||Ic,n.forEach(function(i,a){const s=t.attachments[a],u=i.format,c=i.samples;if(c!==void 0||gu(e,s))e.bindRenderbuffer(Ft,s),c>1?e.renderbufferStorageMultisample(Ft,c,u,r,o):e.renderbufferStorage(Ft,u,r,o);else if(kr(e,s))Qu(e,s,i,r,o);else throw new Error("unknown attachment type")})}function Fa(e,t,n){n=n||Fc,t?(e.bindFramebuffer(n,t.framebuffer),e.viewport(0,0,t.width,t.height)):(e.bindFramebuffer(n,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight))}class K{constructor(t,n,r,o){this.gl=t,this.internalFormat=n,this.format=r,this.texture=ju(t,{width:t.canvas.width,height:t.canvas.height,internalFormat:n,format:r,type:t.UNSIGNED_BYTE,minMag:o,wrap:t.CLAMP_TO_EDGE}),this.framebufferInfo=p_(t,[{attachment:this.texture}],t.canvas.width,t.canvas.height)}framebufferInfo;texture;get isRGBA8(){return this.internalFormat===this.gl.RGBA8&&this.format===this.gl.RGBA}get isR8(){return this.internalFormat===this.gl.R8&&this.format===this.gl.RED}static createRGBA8(t,n=t.LINEAR){return new K(t,t.RGBA8,t.RGBA,n)}static createRGB8(t,n=t.LINEAR){return new K(t,t.RGB8,t.RGB,n)}static createR8(t,n=t.LINEAR){return new K(t,t.R8,t.RED,n)}resize(t,n){Qu(this.gl,this.texture,{width:t,height:n}),b_(this.gl,this.framebufferInfo,[{attachment:this.texture}],t,n)}}class x_{constructor(t){this.canvas=t;const n=t.getContext("webgl2");if(!n)throw new Error("WebGL2 not available for pipeline");this.gl=n,this.bitmapRenderTarget=K.createRGBA8(n)}passChain=[];bitmapRenderTarget;gl;addPass(t){this.passChain.push(t)}applyBitmap(t,n){this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n)}resize(t,n){this.canvas.width=t,this.canvas.height=n,this.bitmapRenderTarget.resize(t,n)}postprocess(t){}async render(t){(this.canvas.width!==t.width||this.canvas.height!==t.height)&&this.resize(t.width,t.height),this.applyBitmap(this.bitmapRenderTarget.texture,t);const n=this.passChain.filter(a=>a.enabled);if(n.length===0)throw new Error("No passes in pipeline");let r=this.bitmapRenderTarget;for(let a=0;a<n.length-1;a++)r=n[a].apply(r);const i=n[n.length-1].applyToScreen(r)??r;return this.postprocess(i)}}const g_=`#version 300 es

in vec2 position;
in vec2 texcoord;

out vec2 v_uv;

void main() {
  v_uv = texcoord;
  gl_Position = vec4(position, 0.0, 1.0);
}`;class Ut{constructor(t,n){this.gl=t,this.settings=n,this.quadBufferInfo=Mu.createXYQuadBufferInfo(t)}get enabled(){return this.settings.enabled}set enabled(t){this.settings.enabled=t}quadBufferInfo;apply(t){return this.applyInternal(t,!1)}applyToScreen(t){return this.applyInternal(t,!0)}executeProgram(t,n,r,o=!1){this.settings.input=n.texture,t.uniformSetters.u_texelSize&&this.settings.setTextelSize(n.framebufferInfo.width,n.framebufferInfo.height),r&&!o&&(r.framebufferInfo.width!==n.framebufferInfo.width||r.framebufferInfo.height!==n.framebufferInfo.height)&&r.resize(n.framebufferInfo.width,n.framebufferInfo.height);const i=r?r.framebufferInfo.width:this.gl.canvas.width,a=r?r.framebufferInfo.height:this.gl.canvas.height;r?Fa(this.gl,r.framebufferInfo):Fa(this.gl,null),this.gl.useProgram(t.program),this.gl.viewport(0,0,i,a),Tc(this.gl,t,this.quadBufferInfo),Di(t,this.settings.uniforms),Ac(this.gl,this.quadBufferInfo)}createProgramInfo(t){return e_(this.gl,[g_,t])}}const y_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;        // R8 luma input
uniform vec2      u_texelSize;    // 1 / texture resolution

uniform float u_sigmaSpatial;     // spatial Gaussian sigma
uniform float u_sigmaRange;       // range (luma) Gaussian sigma
uniform int   u_kernelRadius;     // must be <= MAX_KERNEL_RADIUS

out vec4 outColor;

const int MAX_KERNEL_RADIUS = 5;

void main() {

    vec2 uv = v_uv;

    // Center pixel (luma)
    float centerLuma = texture(u_input, uv).r;

    float weightedSum = 0.0;
    float weightTotal = 0.0;

    // Precompute inverse variances
    float invSpatialVar = 1.0 / (2.0 * u_sigmaSpatial * u_sigmaSpatial);
    float invRangeVar   = 1.0 / (2.0 * u_sigmaRange   * u_sigmaRange);

    for (int ky = -MAX_KERNEL_RADIUS; ky <= MAX_KERNEL_RADIUS; ++ky) {
        for (int kx = -MAX_KERNEL_RADIUS; kx <= MAX_KERNEL_RADIUS; ++kx) {

            // Branchless kernel mask
            float maskX = step(float(abs(kx)), float(u_kernelRadius));
            float maskY = step(float(abs(ky)), float(u_kernelRadius));
            float kernelMask = maskX * maskY;

            vec2 offsetTexel =
                vec2(float(kx), float(ky)) * u_texelSize;

            float neighborLuma =
                texture(u_input, uv + offsetTexel).r;

            float spatialDist2 =
                float(kx * kx + ky * ky);

            float rangeDist2 =
                (neighborLuma - centerLuma) *
                (neighborLuma - centerLuma);

            float weightSpatial =
                exp(-spatialDist2 * invSpatialVar);

            float weightRange =
                exp(-rangeDist2 * invRangeVar);

            float kernelWeight =
                weightSpatial * weightRange * kernelMask;

            weightedSum += neighborLuma * kernelWeight;
            weightTotal += kernelWeight;
        }
    }

    float filteredLuma = weightedSum / weightTotal;

    outColor = vec4(filteredLuma,
                    filteredLuma,
                    filteredLuma,
                    1.0);
}
`;class E_ extends Ut{bilateralProgramInfo;outputRenderTarget;constructor(t,n){super(t,n),this.bilateralProgramInfo=this.createProgramInfo(y_),this.outputRenderTarget=K.createR8(t)}applyInternal(t,n){if(!t.isR8)throw new Error("BilateralPass only supports R8 render targets");return this.executeProgram(this.bilateralProgramInfo,t,n?null:this.outputRenderTarget),this.outputRenderTarget}}class Ot{_enabled=!0;get enabled(){return this._enabled}set enabled(t){this._enabled=t}get input(){return this.uniforms.u_input}set input(t){this.uniforms.u_input=t}get textelSize(){return this.uniforms.u_texelSize}setTextelSize(t,n){this.uniforms.u_texelSize=[1/t,1/n]}uniforms={}}class R_ extends Ot{get sigmaSpatial(){return this.uniforms.u_sigmaSpatial}set sigmaSpatial(t){this.uniforms.u_sigmaSpatial=t}get sigmaRange(){return this.uniforms.u_sigmaRange}set sigmaRange(t){this.uniforms.u_sigmaRange=t}get kernelRadius(){return this.uniforms.u_kernelRadius}set kernelRadius(t){this.uniforms.u_kernelRadius=t}}const S_=`#version 300 es
precision highp float;

in vec2 v_uv;
uniform sampler2D u_input;

out vec4 outColor;

void main() {
    vec3 color = texture(u_input, v_uv).rgb;

    // Rec.709 luma
    float luma = dot(color, vec3(
        0.2126,  // R
        0.7152,  // G
        0.0722   // B
    ));

    outColor = vec4(luma, luma, luma, 1.0);
}
`;class T_ extends Ut{lum709ProgramInfo;outputRenderTarget;constructor(t){super(t,new Ot),this.lum709ProgramInfo=this.createProgramInfo(S_),this.outputRenderTarget=K.createR8(t)}applyInternal(t,n){if(!t.isRGBA8)throw new Error("Rec709LumPass only supports RGBA8 render targets");return this.executeProgram(this.lum709ProgramInfo,t,n?null:this.outputRenderTarget),this.outputRenderTarget}}const A_=`#version 300 es
precision highp float;

in vec2 v_uv;
uniform sampler2D u_input;
uniform int u_flipX;
uniform int u_flipY;

out vec4 outColor;

void main() {
    vec2 uv = v_uv;
    if (u_flipX == 1) uv.x = 1.0 - uv.x;
    if (u_flipY == 1) uv.y = 1.0 - uv.y;
    outColor = texture(u_input, uv);
}
`;class F_ extends Ut{programInfo;outputRenderTarget;constructor(t,n){super(t,n),this.programInfo=this.createProgramInfo(A_),this.outputRenderTarget=K.createR8(t)}applyInternal(t,n){if(!t.isR8)throw new Error("OrientationPass expects R8 render targets");return this.executeProgram(this.programInfo,t,n?null:this.outputRenderTarget),this.outputRenderTarget}}class w_ extends Ot{get flipX(){return!!this.uniforms.u_flipX}set flipX(t){this.uniforms.u_flipX=t?1:0}get flipY(){return!!this.uniforms.u_flipY}set flipY(t){this.uniforms.u_flipY=t?1:0}}const P_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;
uniform vec2      u_texelSize;

out vec4 outColor;

const float sobelDerivative[5] = float[5](
    -2.0, -1.0, 0.0, 1.0, 2.0
);

const float sobelSmoothing[5] = float[5](
     1.0,  4.0, 6.0, 4.0, 1.0
);

// Assumes input luma â [0,1]
const float SOBEL_G_MAX = 48.0;

vec4 packHalf2ToRGBA8LittleEndian(vec2 v)
{
    uint p = packHalf2x16(v);

    return vec4(
        float( p        & 0xFFu),
        float((p >> 8)  & 0xFFu),
        float((p >> 16) & 0xFFu),
        float((p >> 24) & 0xFFu)
    ) / 255.0;
}

void main()
{
    float gx = 0.0;
    float gy = 0.0;

    for (int y = 0; y < 5; y++)
    {
        for (int x = 0; x < 5; x++)
        {
            vec2 o = vec2(float(x - 2), float(y - 2)) * u_texelSize;
            float l = texture(u_input, v_uv + o).r;

            gx += l * sobelDerivative[x] * sobelSmoothing[y];
            gy += l * sobelSmoothing[x] * sobelDerivative[y];
        }
    }

    // Linear normalization (NOT unit length)
    vec2 gN = vec2(gx, gy) / SOBEL_G_MAX;

    // Clamp to representable range
    gN = clamp(gN, -1.0, 1.0);

    // Store as two half-floats packed into RGBA8
    outColor = packHalf2ToRGBA8LittleEndian(gN);
}
`,B_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;
uniform vec2      u_texelSize;

out vec4 outColor;

vec2 unpackHalf2FromRGBA8LittleEndian(vec4 rgba)
{
    // Convert normalized [0,1] back to integer bytes
    uvec4 b = uvec4(rgba * 255.0 + 0.5);

    uint packed =
          (b.x)
        | (b.y << 8)
        | (b.z << 16)
        | (b.w << 24);

    return unpackHalf2x16(packed);
}

vec4 packFloatToRGBA8LittleEndian(float v)
{
    uint bits = floatBitsToUint(v);

    return vec4(
        float( bits        & 0xFFu),
        float((bits >> 8)  & 0xFFu),
        float((bits >> 16) & 0xFFu),
        float((bits >> 24) & 0xFFu)
    ) / 255.0;
}

void main()
{
    vec4 packed = texture(u_input, v_uv);
    vec2 gNorm = unpackHalf2FromRGBA8LittleEndian(packed);

    float magNorm = length(gNorm);

    outColor = packFloatToRGBA8LittleEndian(magNorm);
}
`,C_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input; //gradients
uniform sampler2D u_magnitude;

out vec4 outColor;

vec4 packHalf2ToRGBA8LittleEndian(vec2 v)
{
    uint p = packHalf2x16(v);

    return vec4(
        float( p        & 0xFFu),
        float((p >> 8)  & 0xFFu),
        float((p >> 16) & 0xFFu),
        float((p >> 24) & 0xFFu)
    ) / 255.0;
}

vec2 unpackHalf2FromRGBA8LittleEndian(vec4 rgba)
{
    // Convert normalized [0,1] back to integer bytes
    uvec4 b = uvec4(rgba * 255.0 + 0.5);

    uint packed =
          (b.x)
        | (b.y << 8)
        | (b.z << 16)
        | (b.w << 24);

    return unpackHalf2x16(packed);
}

float unpackFloatFromRGBA8LittleEndian(vec4 rgba)
{
    // Recover integer bytes with round-to-nearest
    uvec4 b = uvec4(rgba * 255.0 + 0.5);

    uint bits =
          (b.x)
        | (b.y << 8)
        | (b.z << 16)
        | (b.w << 24);

    return uintBitsToFloat(bits);
}

void main()
{
    vec4 gradientsPacked = texture(u_input, v_uv);
    vec4 magnitudePacked = texture(u_magnitude, v_uv);

    vec2 gNorm = unpackHalf2FromRGBA8LittleEndian(gradientsPacked);
    float magNorm = unpackFloatFromRGBA8LittleEndian(magnitudePacked);

    magNorm = max(magNorm, 1e-6);

    vec2 unitVectors = clamp(gNorm / magNorm, -1.0,1.0);

    outColor = packHalf2ToRGBA8LittleEndian(unitVectors);
}
`,I_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input; // sobel unit vectors (half2 packed)
uniform sampler2D u_magnitude; 
uniform vec2      u_texelSize;

out vec4 outColor;

vec2 unpackHalf2FromRGBA8LittleEndian(vec4 rgba)
{
    // Convert normalized [0,1] back to integer bytes
    uvec4 b = uvec4(rgba * 255.0 + 0.5);

    uint packed =
          (b.x)
        | (b.y << 8)
        | (b.z << 16)
        | (b.w << 24);

    return unpackHalf2x16(packed);
}

float packDirections(float pos, float neg){
    return (pos*16.0)+neg;
}

vec4 packScore(float directions, float score)
{
    uint q = uint(clamp(score, 0.0, 1.0) * 16777215.0 + 0.5);

    return vec4(
        directions,
        float( q        & 0xFFu),
        float((q >> 8)  & 0xFFu),
        float((q >> 16) & 0xFFu)
    ) / 255.0;
}

float unpackFloatFromRGBA8LittleEndian(vec4 rgba)
{
    // Recover integer bytes with round-to-nearest
    uvec4 b = uvec4(rgba * 255.0 + 0.5);

    uint bits =
          (b.x)
        | (b.y << 8)
        | (b.z << 16)
        | (b.w << 24);

    return uintBitsToFloat(bits);
}

// ---------- neighbor offsets ----------

const vec2 offsets[8] = vec2[8](
    vec2(-1,-1), vec2(-1,0), vec2(-1,1),
    vec2( 0,-1),             vec2( 0,1),
    vec2( 1,-1), vec2( 1,0), vec2( 1,1)
);

const vec2 offsetDirs[8] = vec2[8](
    normalize(vec2(-1.0,-1.0)),
    vec2(-1.0, 0.0),
    normalize(vec2(-1.0, 1.0)),

    vec2( 0.0,-1.0),
    vec2( 0.0, 1.0),

    normalize(vec2( 1.0,-1.0)),
    vec2( 1.0, 0.0),
    normalize(vec2( 1.0, 1.0))
);

const float ARC_THRESHOLD = 0.382683432;
const float EPS = 1e-6;

void main()
{
    // Center data
    vec2 centerVec = unpackHalf2FromRGBA8LittleEndian(texture(u_input, v_uv));
    vec2 centerTangent = vec2(-centerVec.y, centerVec.x);
    float centerMag = unpackFloatFromRGBA8LittleEndian(texture(u_magnitude, v_uv));
    centerMag = max(centerMag, EPS);

    //front and back here just refer to either side of the perimeter pixels.

    float bestFrontScore = 0.0;
    float bestFrontPosition = -1.0;
    float bestFrontIsPositive = 0.0;

    float bestBackScore = 0.0;
    float bestBackPosition = -1.0;

    for(int i = 0; i <4; i++){
        vec2 front_uv = v_uv + offsets[i] * u_texelSize;
        vec2 back_uv = v_uv + offsets[i+4] * u_texelSize;

        vec2 frontVec = unpackHalf2FromRGBA8LittleEndian(texture(u_input, front_uv));
        vec2 backVec = unpackHalf2FromRGBA8LittleEndian(texture(u_input, back_uv));

        float frontMag = unpackFloatFromRGBA8LittleEndian(texture(u_magnitude, front_uv));
        float backMag = unpackFloatFromRGBA8LittleEndian(texture(u_magnitude, back_uv));

        frontMag = max(frontMag, EPS);
        backMag = max(backMag, EPS);

        float frontCos = dot(centerVec, frontVec);
        float backCos = dot(centerVec, backVec);

        //works for both
        float frontDirectionCos = dot(centerTangent, offsetDirs[i]);
        float areEligible = step(ARC_THRESHOLD,abs(frontDirectionCos));

        float frontGradientAgrees = step(0.0, frontCos);
        float backGradientAgrees = step(0.0, backCos);

        float frontMagnitudeAgreement =
            min(centerMag, frontMag) / max(centerMag, frontMag);

        float backMagnitudeAgreement  =
            min(centerMag, backMag) / max(centerMag, backMag);

        float frontScore = abs(frontCos) * frontMagnitudeAgreement * frontGradientAgrees * areEligible;
        float backScore = abs(backCos) * backMagnitudeAgreement * backGradientAgrees * areEligible;

        float frontIsPositive = step(0.0, frontDirectionCos);

        float frontIsBetter = step(bestFrontScore, frontScore);
        float backIsBetter = step(bestBackScore, backScore);

        bestFrontScore = mix(bestFrontScore, frontScore, frontIsBetter);
        bestFrontPosition = mix(float(bestFrontPosition), float(i), frontIsBetter);
        bestFrontIsPositive = mix(bestFrontIsPositive, frontIsPositive, frontIsBetter);

        bestBackScore = mix(bestBackScore, backScore, backIsBetter);
        bestBackPosition = mix(bestBackPosition, float(i+4), backIsBetter);
    }

    float continuity = bestFrontScore * bestBackScore;

    //pack the directions into a byte.
    float positiveDirection = mix(bestBackPosition, bestFrontPosition, bestFrontIsPositive);
    float negativeDirection = mix(bestFrontPosition, bestBackPosition, bestFrontIsPositive);
    float packedDirections = packDirections(positiveDirection, negativeDirection);

    vec4 packedScore = packScore(packedDirections, continuity);

    outColor = packedScore;



}
`,D_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;   // packed Sobel unit normals
uniform vec2      u_texelSize;

out vec4 outColor;

const float PI = 3.14159265358979323846;
const float TWO_PI = 6.28318530717958647692;

/* ---------- packing helpers ---------- */

vec2 unpackHalf2FromRGBA8LittleEndian(vec4 rgba)
{
    uvec4 b = uvec4(rgba * 255.0 + 0.5);
    uint packed =
          (b.x)
        | (b.y << 8)
        | (b.z << 16)
        | (b.w << 24);
    return unpackHalf2x16(packed);
}

vec4 packHalf2ToRGBA8LittleEndian(vec2 v)
{
    uint p = packHalf2x16(v);
    return vec4(
        float( p        & 0xFFu),
        float((p >> 8)  & 0xFFu),
        float((p >> 16) & 0xFFu),
        float((p >> 24) & 0xFFu)
    ) / 255.0;
}

/* ---------- main ---------- */

void main()
{
    // unit normal from Sobel
    vec2 n = unpackHalf2FromRGBA8LittleEndian(texture(u_input, v_uv));

    // pixel-space position, origin at image center
    vec2 p = (v_uv - 0.5) / u_texelSize;

    // signed normal-form Hough parameters
    float theta = atan(n.y, n.x);          // (-Ï, Ï]
    float rho   = dot(p, n);               // signed

    // map theta -> [0, 2Ï)
    theta = mod(theta + TWO_PI, TWO_PI);

    // max rho = distance from center to corner
    vec2  dims   = vec2(1.0 / u_texelSize.x, 1.0 / u_texelSize.y);
    float rhoMax = 0.5 * length(dims);

    // normalize
    float thetaNorm = theta / TWO_PI;      // [0, 1)
    float rhoNorm   = rho / rhoMax;        // [-1, 1]

    outColor = packHalf2ToRGBA8LittleEndian(vec2(thetaNorm, rhoNorm));
}
`;class Ni extends Ut{constructor(t,n){super(t,n),this.structurePassSettings=n,this.sobelGradientsProgramInfo=this.createProgramInfo(P_),this.sobelGradientsRenderTarget=K.createRGBA8(t),this.sobelMagnitudeProgramInfo=this.createProgramInfo(B_),this.sobelMagnitudeRenderTarget=K.createRGBA8(t),this.sobelMagnitudeRGBAReadbackBuffer=new Uint8Array,this.sobelVectorsProgramInfo=this.createProgramInfo(C_),this.sobelVectorsRenderTarget=K.createRGBA8(t),this.sobelContinuityProgramInfo=this.createProgramInfo(I_),this.sobelContinuityRenderTarget=K.createRGBA8(t),this.sobelContinuityRGBAReadbackBuffer=new Uint8Array,this.houghTransformProgramInfo=this.createProgramInfo(D_),this.houghTransformRenderTarget=K.createRGBA8(t),this.houghTransformRGBAReadbackBuffer=new Uint8Array,this.debugProgramInfo=this.createProgramInfo(this.debugFragmentShaderSource),this.debugRenderTarget=K.createRGBA8(t),this.debugQuadBufferInfo=Mu.createXYQuadBufferInfo(t)}sobelGradientsProgramInfo;sobelGradientsRenderTarget;sobelMagnitudeProgramInfo;sobelMagnitudeRenderTarget;sobelMagnitudeRGBAReadbackBuffer;sobelVectorsProgramInfo;sobelVectorsRenderTarget;sobelContinuityProgramInfo;sobelContinuityRenderTarget;sobelContinuityRGBAReadbackBuffer;houghTransformProgramInfo;houghTransformRenderTarget;houghTransformRGBAReadbackBuffer;debugProgramInfo;debugRenderTarget;debugQuadBufferInfo;debugFragmentShaderSource=`
#version 300 es
precision highp float;

in vec2 v_uv;
uniform sampler2D u_input;

out vec4 outColor;

void main() {
outColor = texture(u_input, v_uv);
}
`;applyInternal(t,n){if(!t.isR8)throw new Error("StructurePass expects R8 target");this.executeProgram(this.sobelGradientsProgramInfo,t,this.sobelGradientsRenderTarget),this.executeProgram(this.sobelMagnitudeProgramInfo,this.sobelGradientsRenderTarget,this.sobelMagnitudeRenderTarget),this.executeSobelVectors(),this.executeSobelContinuity(),this.executeProgram(this.houghTransformProgramInfo,this.sobelVectorsRenderTarget,this.houghTransformRenderTarget),this.houghTransformRGBAReadbackBuffer=this.readRGBA8Framebuffer(this.gl,this.houghTransformRenderTarget.framebufferInfo.framebuffer,this.houghTransformRenderTarget.framebufferInfo.width,this.houghTransformRenderTarget.framebufferInfo.height,this.houghTransformRGBAReadbackBuffer),this.sobelMagnitudeRGBAReadbackBuffer=this.readRGBA8Framebuffer(this.gl,this.sobelMagnitudeRenderTarget.framebufferInfo.framebuffer,this.sobelMagnitudeRenderTarget.framebufferInfo.width,this.sobelMagnitudeRenderTarget.framebufferInfo.height,this.sobelMagnitudeRGBAReadbackBuffer),this.sobelContinuityRGBAReadbackBuffer=this.readRGBA8Framebuffer(this.gl,this.sobelContinuityRenderTarget.framebufferInfo.framebuffer,this.sobelContinuityRenderTarget.framebufferInfo.width,this.sobelContinuityRenderTarget.framebufferInfo.height,this.sobelContinuityRGBAReadbackBuffer);const r=Kc(this.structurePassSettings.toRustStruct(),this.sobelMagnitudeRGBAReadbackBuffer,this.sobelContinuityRGBAReadbackBuffer,this.houghTransformRGBAReadbackBuffer);return this.drawLumaArray(this.gl,this.debugProgramInfo,this.debugRenderTarget,this.sobelMagnitudeRenderTarget.framebufferInfo.width,this.sobelMagnitudeRenderTarget.framebufferInfo.height,r),this.sobelContinuityRenderTarget}executeSobelVectors(){this.settings.uniforms.u_magnitude=this.sobelMagnitudeRenderTarget.texture,this.executeProgram(this.sobelVectorsProgramInfo,this.sobelGradientsRenderTarget,this.sobelVectorsRenderTarget)}executeSobelContinuity(){this.settings.uniforms.u_magnitude=this.sobelMagnitudeRenderTarget.texture,this.executeProgram(this.sobelContinuityProgramInfo,this.sobelVectorsRenderTarget,this.sobelContinuityRenderTarget)}readRGBA8Framebuffer(t,n,r,o,i){return(!i||i.length<r*o*4)&&(i=new Uint8Array(r*o*4)),t.bindFramebuffer(t.FRAMEBUFFER,n),t.pixelStorei(t.PACK_ALIGNMENT,1),t.readPixels(0,0,r,o,t.RGBA,t.UNSIGNED_BYTE,i),t.bindFramebuffer(t.FRAMEBUFFER,null),i}drawLumaArray(t,n,r,o,i,a,s=!1){(this.gl.canvas.width!==o||this.gl.canvas.height!==i)&&(this.gl.canvas.width=o,this.gl.canvas.height=i);const u=new Uint8Array(o*i*4);if(s)for(let c=0;c<o*i;c++){const d=Math.max(0,Math.min(1,a[c]))*360,[f,h,m]=Ni.hsvToRgb(d,1,1),_=c*4;u[_+0]=f,u[_+1]=h,u[_+2]=m,u[_+3]=255}else for(let c=0;c<o*i;c++){const l=Math.max(0,Math.min(1,a[c]))*255,d=c*4;u[d+0]=l,u[d+1]=l,u[d+2]=l,u[d+3]=255}t.bindTexture(t.TEXTURE_2D,r.texture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,o,i,0,t.RGBA,t.UNSIGNED_BYTE,u),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,o,i),t.useProgram(n.program),Tc(t,n,this.quadBufferInfo),Di(n,{u_input:r.texture}),Ac(t,this.quadBufferInfo)}static hsvToRgb(t,n,r){const o=r*n,i=t/60,a=o*(1-Math.abs(i%2-1));let s=0,u=0,c=0;i<1?[s,u,c]=[o,a,0]:i<2?[s,u,c]=[a,o,0]:i<3?[s,u,c]=[0,o,a]:i<4?[s,u,c]=[0,a,o]:i<5?[s,u,c]=[a,0,o]:[s,u,c]=[o,0,a];const l=r-o;return[Math.round((s+l)*255),Math.round((u+l)*255),Math.round((c+l)*255)]}}class M_ extends Ot{_conitinuityThreshold=.1;_magnitudeThreshold=.2;get continuityThreshold(){return this._conitinuityThreshold}set continuityThreshold(t){this._conitinuityThreshold=t}get magnitudeThreshold(){return this._magnitudeThreshold}set magnitudeThreshold(t){this._magnitudeThreshold=t}toRustStruct(){return new mr(this._conitinuityThreshold,this._magnitudeThreshold)}}const k_=`#version 300 es
precision highp float;

in vec2 v_uv;

/*
  u_input is always bound by the pipeline
  and represents the CURRENT frame.
*/
uniform sampler2D u_input;

uniform sampler2D u_frame1;
uniform sampler2D u_frame2;
uniform sampler2D u_frame3;
uniform sampler2D u_frame4;

out vec4 outColor;

/*
  Exact median of 5 values.
  Deterministic, branchless.
*/
float median5(
    float v0,
    float v1,
    float v2,
    float v3,
    float v4
) {
    float a = min(v0, v1);
    float b = max(v0, v1);
    float c = min(v2, v3);
    float d = max(v2, v3);

    float e = max(a, c);
    float f = min(b, d);

    float g = min(e, f);
    float h = max(e, f);

    return max(min(h, v4), g);
}

void main() {
    float value0 = texture(u_input,  v_uv).r;
    float value1 = texture(u_frame1, v_uv).r;
    float value2 = texture(u_frame2, v_uv).r;
    float value3 = texture(u_frame3, v_uv).r;
    float value4 = texture(u_frame4, v_uv).r;

    float medianValue =
        median5(value0, value1, value2, value3, value4);

    outColor = vec4(medianValue, medianValue, medianValue, 1.0);
}
`;class N_ extends Ut{programInfo;outputRenderTarget;history=[];historyWriteIndex=0;historyInitialized=!1;constructor(t,n){super(t,n),this.programInfo=this.createProgramInfo(k_),this.outputRenderTarget=K.createR8(t),this.history=[K.createR8(t),K.createR8(t),K.createR8(t),K.createR8(t)]}ensureHistorySized(t,n){for(const r of this.history)(r.framebufferInfo.width!==t||r.framebufferInfo.height!==n)&&r.resize(t,n)}copyToHistory(t){const n=this.gl,r=this.history[this.historyWriteIndex];n.bindFramebuffer(n.READ_FRAMEBUFFER,t.framebufferInfo.framebuffer),n.bindTexture(n.TEXTURE_2D,r.texture),n.copyTexSubImage2D(n.TEXTURE_2D,0,0,0,0,0,t.framebufferInfo.width,t.framebufferInfo.height),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),this.historyWriteIndex=(this.historyWriteIndex+1)%this.history.length}seedHistory(t){for(let n=0;n<this.history.length;n++)this.historyWriteIndex=n,this.copyToHistory(t);this.historyInitialized=!0}applyInternal(t,n){if(!t.isR8)throw new Error("TemporalPass expects R8 or RGBA8 render targets");return this.ensureHistorySized(t.framebufferInfo.width,t.framebufferInfo.height),(this.outputRenderTarget.framebufferInfo.width!==t.framebufferInfo.width||this.outputRenderTarget.framebufferInfo.height!==t.framebufferInfo.height)&&this.outputRenderTarget.resize(t.framebufferInfo.width,t.framebufferInfo.height),this.historyInitialized||this.seedHistory(t),this.settings.uniforms.u_frame1=this.history[0].texture,this.settings.uniforms.u_frame2=this.history[1].texture,this.settings.uniforms.u_frame3=this.history[2].texture,this.settings.uniforms.u_frame4=this.history[3].texture,this.executeProgram(this.programInfo,t,n?null:this.outputRenderTarget),this.copyToHistory(t),this.outputRenderTarget}}class L_ extends Ot{}const G_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;
uniform vec2 u_texelSize;   // 1 / input resolution

out vec4 outColor;

void main()
{
    // Derive input size in pixels
    vec2 inputSize = 1.0 / u_texelSize;

    // Output size (square) inferred from framebuffer
    // v_uv â [0,1], so multiply by output dimension in pixels
    float outSize = min(inputSize.x, inputSize.y);

    // Output pixel coordinate
    vec2 outPx = v_uv * outSize;

    // Center crop origin in input pixel space
    vec2 cropOrigin = 0.5 * (inputSize - vec2(outSize));

    // Input pixel coordinate
    vec2 inPx = cropOrigin + outPx;

    // Convert to UV (pixel-center correct)
    vec2 inUV = (inPx + 0.5) * u_texelSize;

    outColor = texture(u_input, inUV);
}
`,U_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;
uniform vec2 u_texelSize;   // 1 / input resolution

out vec4 outColor;

// 1D kernel: [1 4 6 4 1] / 16
void main()
{
    vec2 dx = vec2(u_texelSize.x, 0.0);

    vec4 c0 = texture(u_input, v_uv - 2.0 * dx);
    vec4 c1 = texture(u_input, v_uv - 1.0 * dx);
    vec4 c2 = texture(u_input, v_uv);
    vec4 c3 = texture(u_input, v_uv + 1.0 * dx);
    vec4 c4 = texture(u_input, v_uv + 2.0 * dx);

    outColor = (c0 + c4) * (1.0 / 16.0)
             + (c1 + c3) * (4.0 / 16.0)
             +  c2        * (6.0 / 16.0);
}
`,O_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;
uniform vec2 u_texelSize;   // 1 / input resolution (the horizontally blurred texture)

out vec4 outColor;

void main()
{
    // derive input size in pixels
    vec2 inSize = 1.0 / u_texelSize;

    // output size is half input size (assumed)
    vec2 outSize = inSize * 0.5;

    // output pixel coordinate (in pixels)
    vec2 outPx = v_uv * outSize;

    // map to input pixel center at (2x+0.5, 2y+0.5)
    vec2 inPxCenter = outPx * 2.0 + vec2(0.5);

    // convert to UV
    vec2 baseUV = inPxCenter * u_texelSize;

    // vertical taps around that center in input texels
    vec2 dy = vec2(0.0, u_texelSize.y);

    vec4 c0 = texture(u_input, baseUV - 2.0 * dy);
    vec4 c1 = texture(u_input, baseUV - 1.0 * dy);
    vec4 c2 = texture(u_input, baseUV);
    vec4 c3 = texture(u_input, baseUV + 1.0 * dy);
    vec4 c4 = texture(u_input, baseUV + 2.0 * dy);

    outColor = (c0 + c4) * (1.0 / 16.0)
             + (c1 + c3) * (4.0 / 16.0)
             +  c2        * (6.0 / 16.0);
}
`;class Vn extends Ut{cropProgramInfo;downscaleHorizontalProgramInfo;downscaleVerticalProgramInfo;downscaleRenderTargetPing;downscaleRenderTargetPong;static DOWNSCALE_LIMIT=640;constructor(t,n){super(t,n),this.cropProgramInfo=this.createProgramInfo(G_),this.downscaleHorizontalProgramInfo=this.createProgramInfo(U_),this.downscaleVerticalProgramInfo=this.createProgramInfo(O_),this.downscaleRenderTargetPing=K.createR8(t),this.downscaleRenderTargetPong=K.createR8(t)}applyInternal(t,n){if(!t.isR8)throw new Error("DownscalePass only supports R8 input textures.");let r=this.downscaleRenderTargetPing,o=this.downscaleRenderTargetPong,i=Math.min(t.framebufferInfo.width,t.framebufferInfo.height);for(r.resize(i,i),this.executeProgram(this.cropProgramInfo,t,i<=Vn.DOWNSCALE_LIMIT&&n?null:r,!0);i>Vn.DOWNSCALE_LIMIT;){this.executeProgram(this.downscaleHorizontalProgramInfo,r,o),[r,o]=[o,r],i=Math.floor(i/2),o.resize(i,i);let a=!1;i<=Vn.DOWNSCALE_LIMIT&&n&&(a=!0),this.executeProgram(this.downscaleVerticalProgramInfo,r,a?null:o,!0),[r,o]=[o,r]}return r}}const z_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;
uniform vec2 u_corners[4];
uniform float u_thickness;

out vec4 outColor;

float segmentDistance(vec2 p, vec2 a, vec2 b) {
    vec2 ab = b - a;
    float t = clamp(dot(p - a, ab) / dot(ab, ab), 0.0, 1.0);
    vec2 closest = a + t * ab;
    return length(p - closest);
}

void main() {
    vec4 base = texture(u_input, v_uv);

    vec2 p = v_uv;
    float d0 = segmentDistance(p, u_corners[0], u_corners[1]);
    float d1 = segmentDistance(p, u_corners[1], u_corners[2]);
    float d2 = segmentDistance(p, u_corners[2], u_corners[3]);
    float d3 = segmentDistance(p, u_corners[3], u_corners[0]);

    float minDist = min(min(d0, d1), min(d2, d3));

    float edge = step(u_thickness, minDist);
    float mask = 1.0 - edge;

    outColor = mix(base, vec4(1.0, 1.0, 1.0, 1.0), mask);
}
`;class V_ extends Ut{boxProgramInfo;outputRenderTarget;pixelBuffer=null;pixelChannels=0;lastBox=null;constructor(t,n){super(t,n),this.boxProgramInfo=this.createProgramInfo(z_),this.outputRenderTarget=K.createRGBA8(t)}ensurePixelBuffer(t,n,r){const o=t*n*r;(!this.pixelBuffer||this.pixelBuffer.length!==o)&&(this.pixelBuffer=new Uint8Array(o)),this.pixelChannels=r}readPixelsToBuffer(t){const n=t.framebufferInfo.width,r=t.framebufferInfo.height,o=t.isR8,i=o?this.gl.RED:this.gl.RGBA,a=o?1:4;return this.ensurePixelBuffer(n,r,a),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t.framebufferInfo.framebuffer),this.gl.readPixels(0,0,n,r,i,this.gl.UNSIGNED_BYTE,this.pixelBuffer),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),{width:n,height:r}}sampleMax3x3(t,n,r,o){if(!this.pixelBuffer)return 0;const i=Math.round(t),a=Math.round(n);let s=0;for(let u=-1;u<=1;u++)for(let c=-1;c<=1;c++){const l=Math.max(0,Math.min(r-1,i+c)),d=Math.max(0,Math.min(o-1,a+u)),h=((o-1-d)*r+l)*this.pixelChannels,m=this.pixelBuffer[h]/255;m>s&&(s=m)}return s}findRayHits(t,n,r,o,i){const a=(t-1)*.5,s=(n-1)*.5,u=[];for(let c=0;c<o;c++){const l=c/o*Math.PI*2,d=Math.cos(l),f=Math.sin(l),h=d>0?(t-1-a)/d:d<0?-a/d:1/0,m=f>0?(n-1-s)/f:f<0?-s/f:1/0,_=Math.min(h,m);if(isFinite(_))for(let v=_;v>=0;v-=i){const b=a+d*v,y=s+f*v;if(this.sampleMax3x3(b,y,t,n)>=r){u.push({x:b/(t-1),y:y/(n-1)});break}}}return u}computeOBBCorners(t,n){if(t.length<4)return[{x:.5-.25,y:.5-.25},{x:.5+.25,y:.5-.25},{x:.5+.25,y:.5+.25},{x:.5-.25,y:.5+.25}];let r=0,o=0;for(const E of t)r+=E.x,o+=E.y;r/=t.length,o/=t.length;let i=0,a=0,s=0;for(const E of t){const A=E.x-r,I=E.y-o;i+=A*A,a+=A*I,s+=I*I}const u=i+s,c=i*s-a*a,l=Math.sqrt(Math.max(0,u*u-4*c)),d=(u+l)*.5;let f=a,h=d-i;const m=Math.hypot(f,h)||1;f/=m,h/=m;const _=-h,v=f,b=[],y=[];for(const E of t){const A=E.x-r,I=E.y-o;b.push(A*f+I*h),y.push(A*_+I*v)}b.sort((E,A)=>E-A),y.sort((E,A)=>E-A);const g=Math.floor(b.length*Math.min(Math.max(n,0),.45)),R=b[g],x=b[b.length-1-g],T=y[g],F=y[y.length-1-g],B=[{x:r+R*f+T*_,y:o+R*h+T*v},{x:r+x*f+T*_,y:o+x*h+T*v},{x:r+x*f+F*_,y:o+x*h+F*v},{x:r+R*f+F*_,y:o+R*h+F*v}];for(const E of B)E.x=Math.max(0,Math.min(1,E.x)),E.y=Math.max(0,Math.min(1,E.y));return B}applyInternal(t,n){const r=this.settings,{width:o,height:i}=this.readPixelsToBuffer(t),a=this.findRayHits(o,i,r.threshold,Math.max(32,r.rayCount),r.step),s=this.computeOBBCorners(a,r.trimFraction);return this.lastBox={corners:s},this.settings.uniforms.u_corners=[s[0].x,1-s[0].y,s[1].x,1-s[1].y,s[2].x,1-s[2].y,s[3].x,1-s[3].y],this.settings.uniforms.u_thickness=1.5/Math.max(o,i),this.settings.uniforms.u_input=t.texture,this.executeProgram(this.boxProgramInfo,t,n?null:this.outputRenderTarget),this.outputRenderTarget}}class H_ extends Ot{_threshold=.2;_rayCount=64;_step=.5;_trimFraction=.12;_angleThreshold=0;_distanceThreshold=0;get threshold(){return this._threshold}set threshold(t){this._threshold=t}get rayCount(){return this._rayCount}set rayCount(t){this._rayCount=t}get step(){return this._step}set step(t){this._step=t}get trimFraction(){return this._trimFraction}set trimFraction(t){this._trimFraction=t}get angleThreshold(){return this._angleThreshold}set angleThreshold(t){this._angleThreshold=t}get distanceThreshold(){return this._distanceThreshold}set distanceThreshold(t){this._distanceThreshold=t}}class wa extends x_{passes;passMap;rayBoxPass;constructor(t){super(t);const n=new T_(this.gl),r=new w_;r.flipX=!1,r.flipY=!1;const o=new F_(this.gl,r),i=new L_;i.enabled=!0;const a=new N_(this.gl,i),s=new R_;s.kernelRadius=2,s.sigmaSpatial=2,s.sigmaRange=.1;const u=new E_(this.gl,s),c=new Ot,l=new Vn(this.gl,c),d=new M_;d.magnitudeThreshold=.8,d.continuityThreshold=.8;const f=new Ni(this.gl,d),h=new H_;h.threshold=.12,h.rayCount=64,h.step=.5,h.trimFraction=.12,this.rayBoxPass=new V_(this.gl,h),this.passes=[{id:"rec709-luma",label:"Rec709 Luma",required:!0,pass:n},{id:"orientation",label:"Orientation",required:!1,pass:o},{id:"temporal",label:"Temporal Median",required:!1,pass:a},{id:"bilateral",label:"Bilateral",required:!1,pass:u},{id:"downscale",label:"Downscale",required:!1,pass:l},{id:"sobel",label:"Structure",required:!1,pass:f},{id:"ray-box",label:"Ray Box",required:!1,pass:this.rayBoxPass}],this.passMap=new Map(this.passes.map(m=>[m.id,m]));for(const m of this.passes)this.addPass(m.pass)}getPass(t){return this.passMap.get(t)?.pass}postprocess(){return{box:this.rayBoxPass.lastBox}}}class fn{constructor(t){this.mediaStreamTrack=t,this.imageCapture=new ImageCapture(t)}static _imageCaptureContexts=new Map;static _initialized=!1;static get imageCaptureContexts(){if(!fn._initialized)throw new Error("ImageCaptureContext not initialized. Call ImageCaptureContext.initialize() first.");return fn._imageCaptureContexts}imageCapture;static async initialize(){await this.refreshVideoTracks(),this._initialized=!0}static async refreshVideoTracks(){await navigator.mediaDevices.getUserMedia({video:!0});const n=(await navigator.mediaDevices.enumerateDevices()).filter(o=>o.kind==="videoinput"),r=new Set;for(const o of n){const a=(await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:o.deviceId}}})).getVideoTracks()[0];r.add(a.id),this._imageCaptureContexts.has(a.id)||this._imageCaptureContexts.set(a.id,new fn(a))}for(const[o]of this._imageCaptureContexts)r.has(o)||this._imageCaptureContexts.delete(o)}}var X_=ee('<button type="button" role="tab"> </button>'),$_=ee('<div class="passBar" role="tablist" aria-label="Pipeline passes"></div>');function q_(e,t){_e(t,!1);let n=X(t,"passes",24,()=>[]),r=X(t,"selectedPassId",8);const o=ti();Ce();var i=$_();No(i,5,n,a=>a.id,(a,s)=>{var u=X_();let c;var l=L(u);Te(()=>{c=Go(u,1,"passButton",null,c,{passButtonActive:r()===p(s).id}),lr(u,"aria-selected",(Pe(r()),p(s),we(()=>r()===p(s).id))),et(l,(p(s),we(()=>p(s).label)))}),cn("click",u,()=>o("select",{passId:p(s).id})),N(a,u)}),N(e,i),ve()}var Y_=ee('<label class="setting"><div class="settingLabel"> </div> <div class="settingControl sliderControl svelte-2wv2v5"><div class="sliderShell svelte-2wv2v5"><div class="sliderTrack svelte-2wv2v5"><input class="sliderInput svelte-2wv2v5" type="range"/></div> <div class="settingValue svelte-2wv2v5"> </div></div></div></label>');function Le(e,t){_e(t,!1);let n=X(t,"label",8),r=X(t,"min",8),o=X(t,"max",8),i=X(t,"step",8),a=X(t,"value",8);const s=ti();Ce();var u=Y_(),c=L(u),l=L(c),d=z(c,2),f=L(d),h=L(f),m=L(h),_=z(h,2),v=L(_);Te(()=>{et(l,n()),lr(m,"min",r()),lr(m,"max",o()),lr(m,"step",i()),Bf(m,a()),et(v,a())}),cn("input",m,b=>s("input",{value:Number(b.currentTarget.value)})),N(e,u),ve()}var K_=ee('<label class="setting toggleSetting"><div class="settingLabel"> </div> <div class="settingControl"><input type="checkbox"/></div></label>');function tt(e,t){_e(t,!1);let n=X(t,"label",8),r=X(t,"checked",8);const o=ti();Ce();var i=K_(),a=L(i),s=L(a),u=z(a,2),c=L(u);Te(()=>{et(s,n()),Cf(c,r())}),cn("change",c,l=>o("change",{checked:l.currentTarget.checked})),N(e,i),ve()}var W_=ee('<div class="settings"><!> <!> <!> <!></div>');function j_(e,t){_e(t,!1);let n=X(t,"settings",12),r=X(t,"required",8,!1);const o=5,i=2,a=.5,s=o/3;let u=M(n().enabled),c=M(n().kernelRadius),l=M(n().sigmaSpatial),d=M(n().sigmaRange);function f(E,A,I){return Math.max(A,Math.min(I,E))}function h(E){return Math.ceil(3*E)}function m(E){return E/3}function _(E){S(u,E),n(n().enabled=E,!0)}function v(E){const A=f(Math.round(E),i,o),I=m(A),W=Math.min(n().sigmaSpatial,I);S(c,A),S(l,W),n(n().kernelRadius=A,!0),n(n().sigmaSpatial=W,!0)}function b(E){const A=f(E,a,s),I=h(A),W=f(I,i,o);S(l,A),S(c,W),n(n().sigmaSpatial=A,!0),n(n().kernelRadius=W,!0)}function y(E){S(d,E),n(n().sigmaRange=E,!0)}_t(()=>Pe(n()),()=>{n()&&(S(u,n().enabled),S(c,n().kernelRadius),S(l,n().sigmaSpatial),S(d,n().sigmaRange))}),vt(),Ce();var g=W_(),R=L(g);{var x=E=>{tt(E,{label:"Enabled",get checked(){return p(u)},$$events:{change:A=>_(A.detail.checked)}})};J(R,E=>{r()||E(x)})}var T=z(R,2);Le(T,{label:"Kernel Radius",min:i,max:o,step:1,get value(){return p(c)},$$events:{input:E=>v(E.detail.value)}});var F=z(T,2);Le(F,{label:"Sigma Spatial",min:a,max:s,step:.1,get value(){return p(l)},$$events:{input:E=>b(E.detail.value)}});var B=z(F,2);Le(B,{label:"Sigma Range",min:.01,max:.5,step:.01,get value(){return p(d)},$$events:{input:E=>y(E.detail.value)}}),N(e,g),ve()}var Q_=ee('<div class="settings"><div class="settingsEmpty">Rec709 is required and has no settings.</div></div>');function Z_(e){var t=Q_();N(e,t)}var J_=ee('<div class="settings"><!> <!> <!></div>');function ev(e,t){_e(t,!1);let n=X(t,"settings",12),r=X(t,"required",8,!1),o=M(n().enabled),i=M(n().continuityThreshold),a=M(n().magnitudeThreshold);function s(_){S(o,_),n(n().enabled=_,!0)}function u(_){S(i,_),n(n().continuityThreshold=_,!0)}function c(_){S(a,_),n(n().magnitudeThreshold=_,!0)}_t(()=>Pe(n()),()=>{n()&&(S(o,n().enabled),S(i,n().continuityThreshold),S(a,n().magnitudeThreshold))}),vt(),Ce();var l=J_(),d=L(l);{var f=_=>{tt(_,{label:"Enabled",get checked(){return p(o)},$$events:{change:v=>s(v.detail.checked)}})};J(d,_=>{r()||_(f)})}var h=z(d,2);Le(h,{label:"Magnitude Threshold",min:0,max:1,step:.01,get value(){return p(a)},$$events:{input:_=>c(_.detail.value)}});var m=z(h,2);Le(m,{label:"Continuity Threshold",min:0,max:1,step:.01,get value(){return p(i)},$$events:{input:_=>u(_.detail.value)}}),N(e,l),ve()}var tv=ee('<div class="settings"><!> <div class="settingsEmpty">Downscale crops to a square and downsamples before structure.</div></div>');function nv(e,t){_e(t,!1);let n=X(t,"settings",12),r=X(t,"required",8,!1),o=M(n().enabled);function i(c){S(o,c),n(n().enabled=c,!0)}_t(()=>Pe(n()),()=>{n()&&S(o,n().enabled)}),vt(),Ce();var a=tv(),s=L(a);{var u=c=>{tt(c,{label:"Enabled",get checked(){return p(o)},$$events:{change:l=>i(l.detail.checked)}})};J(s,c=>{r()||c(u)})}N(e,a),ve()}var rv=ee('<div class="settings"><!> <!></div>');function ov(e,t){_e(t,!1);let n=X(t,"settings",12),r=X(t,"required",8,!1),o=M(n().enabled),i=M(n().threshold);function a(f){S(o,f),n(n().enabled=f,!0)}function s(f){S(i,f),n(n().threshold=f,!0)}_t(()=>Pe(n()),()=>{n()&&(S(o,n().enabled),S(i,n().threshold))}),vt(),Ce();var u=rv(),c=L(u);{var l=f=>{tt(f,{label:"Enabled",get checked(){return p(o)},$$events:{change:h=>a(h.detail.checked)}})};J(c,f=>{r()||f(l)})}var d=z(c,2);Le(d,{label:"Threshold",min:0,max:.5,step:.005,get value(){return p(i)},$$events:{input:f=>s(f.detail.value)}}),N(e,u),ve()}var iv=ee('<div class="settings"><!> <div class="settingsEmpty">Uses last 4 frames (median). No tunable parameters.</div></div>');function sv(e,t){_e(t,!1);let n=X(t,"settings",12),r=X(t,"required",8,!1),o=M(n().enabled);function i(c){S(o,c),n(n().enabled=c,!0)}_t(()=>Pe(n()),()=>{n()&&S(o,n().enabled)}),vt(),Ce();var a=iv(),s=L(a);{var u=c=>{tt(c,{label:"Enabled",get checked(){return p(o)},$$events:{change:l=>i(l.detail.checked)}})};J(s,c=>{r()||c(u)})}N(e,a),ve()}var av=ee('<div class="settings"><!> <!> <!> <!> <!></div>');function uv(e,t){_e(t,!1);let n=X(t,"settings",12),r=X(t,"required",8,!1),o=M(n().enabled),i=M(n().threshold),a=M(n().rayCount),s=M(n().step),u=M(n().trimFraction);function c(x){S(o,x),n(n().enabled=x,!0)}function l(x){S(i,x),n(n().threshold=x,!0)}function d(x){S(a,x),n(n().rayCount=x,!0)}function f(x){S(s,x),n(n().step=x,!0)}function h(x){S(u,x),n(n().trimFraction=x,!0)}_t(()=>Pe(n()),()=>{n()&&(S(o,n().enabled),S(i,n().threshold),S(a,n().rayCount),S(s,n().step),S(u,n().trimFraction))}),vt(),Ce();var m=av(),_=L(m);{var v=x=>{tt(x,{label:"Enabled",get checked(){return p(o)},$$events:{change:T=>c(T.detail.checked)}})};J(_,x=>{r()||x(v)})}var b=z(_,2);Le(b,{label:"Threshold",min:0,max:.5,step:.005,get value(){return p(i)},$$events:{input:x=>l(x.detail.value)}});var y=z(b,2);Le(y,{label:"Ray Count",min:32,max:256,step:8,get value(){return p(a)},$$events:{input:x=>d(Math.round(x.detail.value))}});var g=z(y,2);Le(g,{label:"Step (px)",min:.25,max:5,step:.25,get value(){return p(s)},$$events:{input:x=>f(x.detail.value)}});var R=z(g,2);Le(R,{label:"Trim Fraction",min:0,max:.4,step:.01,get value(){return p(u)},$$events:{input:x=>h(x.detail.value)}}),N(e,m),ve()}var cv=ee('<div class="settings"><!> <!> <!></div>');function lv(e,t){_e(t,!1);let n=X(t,"settings",12),r=X(t,"required",8,!1),o=M(n().enabled),i=M(n().flipX),a=M(n().flipY);function s(_){S(o,_),n(n().enabled=_,!0)}function u(_){S(i,_),n(n().flipX=_,!0)}function c(_){S(a,_),n(n().flipY=_,!0)}_t(()=>Pe(n()),()=>{n()&&(S(o,n().enabled),S(i,n().flipX),S(a,n().flipY))}),vt(),Ce();var l=cv(),d=L(l);{var f=_=>{tt(_,{label:"Enabled",get checked(){return p(o)},$$events:{change:v=>s(v.detail.checked)}})};J(d,_=>{r()||_(f)})}var h=z(d,2);tt(h,{label:"Flip X",get checked(){return p(i)},$$events:{change:_=>u(_.detail.checked)}});var m=z(h,2);tt(m,{label:"Flip Y",get checked(){return p(a)},$$events:{change:_=>c(_.detail.checked)}}),N(e,l),ve()}var fv=ee('<div class="fpsBadge svelte-1dp3x29" aria-label="Frames per second"> </div>');function dv(e,t){_e(t,!1);let n=M(0),r=0,o=performance.now();function i(){const c=performance.now();r+=1;const l=c-o;l>=500&&(S(n,Math.round(r*1e3/l)),r=0,o=c)}var a={measure:i},s=fv(),u=L(s);return Te(()=>et(u,`${p(n)??""} fps`)),N(e,s),Df(t,"measure",i),ve(a)}function hv(e){const t=e-1;return t*t*t+1}function Pa(e){const t=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}function mv(e,{delay:t=0,duration:n=400,easing:r=hv,x:o=0,y:i=0,opacity:a=0}={}){const s=getComputedStyle(e),u=+s.opacity,c=s.transform==="none"?"":s.transform,l=u*(1-a),[d,f]=Pa(o),[h,m]=Pa(i);return{delay:t,duration:n,easing:r,css:(_,v)=>`
			transform: ${c} translate(${(1-_)*d}${f}, ${(1-_)*h}${m});
			opacity: ${u-l*v}`}}var _v=ee('<div class="toast svelte-1fk2ial" role="status"> </div>');function vv(e,t){_e(t,!1);let n=X(t,"message",8,""),r=X(t,"open",12,!1),o=X(t,"duration",8,2e3),i=M(null);_t(()=>(Pe(r()),p(i),Pe(o())),()=>{r()&&(p(i)&&clearTimeout(p(i)),S(i,setTimeout(()=>r(!1),o())))}),vt();var a=re(),s=ne(a);{var u=c=>{var l=_v(),d=L(l);Te(()=>et(d,n())),Tf(3,l,()=>mv,()=>({y:10,duration:150})),N(c,l)};J(s,c=>{r()&&c(u)})}N(e,a),ve()}const pv={"rec709-luma":{enabled:!0},orientation:{enabled:!0,flipX:!0,flipY:!1},temporal:{enabled:!0},bilateral:{enabled:!0,kernelRadius:2,sigmaSpatial:2,sigmaRange:.1},downscale:{enabled:!0},sobel:{enabled:!1,magnitudeThreshold:.8,continuityThreshold:.8},"ray-box":{enabled:!1}},bv={passes:pv},xv={"rec709-luma":{enabled:!0},orientation:{enabled:!0,flipX:!0,flipY:!1},temporal:{enabled:!0},bilateral:{enabled:!0,kernelRadius:2,sigmaSpatial:2,sigmaRange:.1},downscale:{enabled:!0},sobel:{enabled:!0,magnitudeThreshold:.8,continuityThreshold:.8},"ray-box":{enabled:!1}},gv={passes:xv};var yv=ee("<option> </option>"),Ev=ee("<option> </option>"),Rv=ee('<div class="errorBanner svelte-1n46o8q" role="alert"> </div>'),Sv=ee('<main class="app svelte-1n46o8q"><section class="controls svelte-1n46o8q"><div class="controlRow svelte-1n46o8q"><div class="sideSwitcher svelte-1n46o8q" role="group" aria-label="Side selector"><button type="button">Front</button> <button type="button">Rear</button></div> <!> <button class="exportButton svelte-1n46o8q" type="button">Export</button></div> <!></section> <section class="views svelte-1n46o8q"><div class="cameraPanel svelte-1n46o8q"><div class="cameraHeader svelte-1n46o8q"><div class="cameraTitle svelte-1n46o8q">Front</div> <select class="cameraSelect svelte-1n46o8q"><option disabled>Select inputâ¦</option><!></select></div> <canvas class="cameraCanvas svelte-1n46o8q"></canvas></div> <div class="cameraPanel svelte-1n46o8q"><div class="cameraHeader svelte-1n46o8q"><div class="cameraTitle svelte-1n46o8q">Rear</div> <select class="cameraSelect svelte-1n46o8q"><option disabled>Select inputâ¦</option><!></select></div> <canvas class="cameraCanvas svelte-1n46o8q"></canvas></div></section> <!> <!> <!></main>');function Tv(e,t){_e(t,!1);const n={"rec709-luma":Z_,bilateral:j_,sobel:ev,downscale:nv,"magnatude-gate":ov,temporal:sv,"ray-box":uv,orientation:lv};let r=M(""),o=new Map,i=M([]),a=M(""),s=M(""),u=M("front"),c=M(null),l=M(null),d=M(null),f=M(null),h=M([]),m=M(null),_=!1,v=!1,b=M(null),y=M(!1),g=M("");function R(){S(i,Array.from(o.entries()).map(([w,P])=>({id:w,label:`${P.mediaStreamTrack.label||"Camera"} (${w})`})))}async function x(){await fn.initialize(),o=fn.imageCaptureContexts,R(),!p(a)&&p(i)[0]&&S(a,p(i)[0].id),!p(s)&&p(i)[1]&&S(s,p(i)[1].id),!p(s)&&p(i)[0]&&S(s,p(i)[0].id)}function T(w,P){const D=P?.getPass(w);return D?D.settings:null}function F(w,P){const D=P?.passes??{};for(const V of w.passes){const U=D[V.id];if(U){typeof U.enabled=="boolean"&&(V.pass.enabled=U.enabled);for(const[$t,Wr]of Object.entries(U))$t!=="enabled"&&$t in V.pass.settings&&(V.pass.settings[$t]=Wr)}}}function B(w){const P={};for(const D of w.passes){const V={enabled:D.pass.enabled},U=D.pass.settings;switch(D.id){case"bilateral":V.kernelRadius=U.kernelRadius,V.sigmaSpatial=U.sigmaSpatial,V.sigmaRange=U.sigmaRange;break;case"sobel":V.continuityThreshold=U.continuityThreshold,V.magnitudeThreshold=U.magnitudeThreshold;break;case"magnatude-gate":V.threshold=U.threshold;break;case"temporal":break;case"orientation":V.flipX=U.flipX,V.flipY=U.flipY;break;case"ray-box":V.threshold=U.threshold,V.rayCount=U.rayCount,V.step=U.step,V.trimFraction=U.trimFraction;break}P[D.id]=V}return{passes:P}}async function E(w){const P=p(w==="front"?d:f);if(!P)return;const D=JSON.stringify(B(P),null,2);await navigator.clipboard.writeText(D),S(g,`Exported ${w} settings to clipboard`),S(y,!0)}async function A(w,P){if(!w||!P)return;const D=o.get(P);if(!D)return;const V=await D.imageCapture.grabFrame();try{await w.render(V)}finally{V.close()}}async function I(){if(_){if(v){p(b)?.measure(),requestAnimationFrame(()=>{I()});return}v=!0;try{p(b)?.measure(),await A(p(d),p(a)),await A(p(f),p(s)),S(m,null)}catch(w){S(m,w instanceof Error?w.message:String(w))}finally{v=!1,requestAnimationFrame(()=>{I()})}}}mu(async()=>{try{if(await x(),!p(c)||!p(l)){S(m,"Canvas not available for one or both views.");return}S(d,new wa(p(c))),S(f,new wa(p(l))),p(d)&&F(p(d),bv),p(f)&&F(p(f),gv),S(h,p(d).passes),S(r,p(h)[0]?.id??""),_=!0,I()}catch(w){S(m,w instanceof Error?w.message:String(w))}}),kf(()=>{_=!1}),Ce();var W=Sv(),te=L(W),pe=L(te),ge=L(pe),Ie=L(ge);let $e;var qe=z(Ie,2);let Ye;var yt=z(ge,2);{let w=at(()=>p(h).map(P=>({id:P.id,label:P.label})));q_(yt,{get passes(){return p(w)},get selectedPassId(){return p(r)},$$events:{select:P=>S(r,P.detail.passId)}})}var zt=z(yt,2),Vt=z(pe,2);{var Ht=w=>{const P=at(()=>p(h).find(Sn=>Sn.id===p(r))),D=at(()=>p(P)?n[p(P).id]:null),V=at(()=>p(u)==="front"?p(d):p(f)),U=at(()=>p(P)?T(p(P).id,p(V)):null);var $t=re(),Wr=ne($t);{var Gc=Sn=>{var zi=re(),Uc=ne(zi);{var Oc=qt=>{var Tn=re(),jr=ne(Tn);it(jr,()=>p(D),(Qr,Zr)=>{Zr(Qr,{get required(){return p(P).required},get settings(){return p(U)}})}),N(qt,Tn)},zc=qt=>{var Tn=re(),jr=ne(Tn);{var Qr=Yt=>{var An=re(),Jr=ne(An);it(Jr,()=>p(D),(eo,to)=>{to(eo,{get required(){return p(P).required},get settings(){return p(U)}})}),N(Yt,An)},Zr=Yt=>{var An=re(),Jr=ne(An);{var eo=Kt=>{var Fn=re(),no=ne(Fn);it(no,()=>p(D),(ro,oo)=>{oo(ro,{get required(){return p(P).required},get settings(){return p(U)}})}),N(Kt,Fn)},to=Kt=>{var Fn=re(),no=ne(Fn);{var ro=Wt=>{var wn=re(),io=ne(wn);it(io,()=>p(D),(so,ao)=>{ao(so,{get required(){return p(P).required},get settings(){return p(U)}})}),N(Wt,wn)},oo=Wt=>{var wn=re(),io=ne(wn);{var so=jt=>{var Pn=re(),uo=ne(Pn);it(uo,()=>p(D),(co,lo)=>{lo(co,{get required(){return p(P).required},get settings(){return p(U)}})}),N(jt,Pn)},ao=jt=>{var Pn=re(),uo=ne(Pn);{var co=Qt=>{var Bn=re(),fo=ne(Bn);it(fo,()=>p(D),(ho,mo)=>{mo(ho,{get required(){return p(P).required},get settings(){return p(U)}})}),N(Qt,Bn)},lo=Qt=>{var Bn=re(),fo=ne(Bn);{var ho=Zt=>{var Cn=re(),_o=ne(Cn);it(_o,()=>p(D),(vo,po)=>{po(vo,{get required(){return p(P).required},get settings(){return p(U)}})}),N(Zt,Cn)},mo=Zt=>{var Cn=re(),_o=ne(Cn);it(_o,()=>p(D),(vo,po)=>{po(vo,{get required(){return p(P).required}})}),N(Zt,Cn)};J(fo,Zt=>{p(P).id==="ray-box"?Zt(ho):Zt(mo,!1)},!0)}N(Qt,Bn)};J(uo,Qt=>{p(P).id==="temporal"?Qt(co):Qt(lo,!1)},!0)}N(jt,Pn)};J(io,jt=>{p(P).id==="magnatude-gate"?jt(so):jt(ao,!1)},!0)}N(Wt,wn)};J(no,Wt=>{p(P).id==="orientation"?Wt(ro):Wt(oo,!1)},!0)}N(Kt,Fn)};J(Jr,Kt=>{p(P).id==="sobel"?Kt(eo):Kt(to,!1)},!0)}N(Yt,An)};J(jr,Yt=>{p(P).id==="downscale"?Yt(Qr):Yt(Zr,!1)},!0)}N(qt,Tn)};J(Uc,qt=>{p(P).id==="bilateral"?qt(Oc):qt(zc,!1)})}N(Sn,zi)};J(Wr,Sn=>{p(P)&&p(D)&&p(U)&&Sn(Gc)})}N(w,$t)};J(Vt,w=>{p(r)&&w(Ht)})}var Et=z(te,2),Rt=L(Et),En=L(Rt),Rn=z(L(En),2);Te(()=>{p(a),Wi(()=>{p(i)})});var Xt=L(Rn);Xt.value=Xt.__value="";var Zn=z(Xt);No(Zn,1,()=>p(i),w=>w.id,(w,P)=>{var D=yv(),V=L(D),U={};Te(()=>{et(V,p(P).id),U!==(U=p(P).id)&&(D.value=(D.__value=p(P).id)??"")}),N(w,D)});var Z=z(En,2);go(Z,w=>S(c,w),()=>p(c));var Dc=z(Rt,2),Li=L(Dc),Gi=z(L(Li),2);Te(()=>{p(s),Wi(()=>{p(i)})});var Kr=L(Gi);Kr.value=Kr.__value="";var Mc=z(Kr);No(Mc,1,()=>p(i),w=>w.id,(w,P)=>{var D=Ev(),V=L(D),U={};Te(()=>{et(V,p(P).id),U!==(U=p(P).id)&&(D.value=(D.__value=p(P).id)??"")}),N(w,D)});var kc=z(Li,2);go(kc,w=>S(l,w),()=>p(l));var Ui=z(Et,2);{var Nc=w=>{var P=Rv(),D=L(P);Te(()=>et(D,p(m))),N(w,P)};J(Ui,w=>{p(m)&&w(Nc)})}var Oi=z(Ui,2);go(dv(Oi,{$$legacy:!0}),w=>S(b,w),()=>p(b));var Lc=z(Oi,2);vv(Lc,{get message(){return p(g)},get open(){return p(y)},set open(w){S(y,w)},$$legacy:!0}),Te(()=>{$e=Go(Ie,1,"svelte-1n46o8q",null,$e,{sideActive:p(u)==="front"}),Ye=Go(qe,1,"svelte-1n46o8q",null,Ye,{sideActive:p(u)==="rear"})}),cn("click",Ie,()=>S(u,"front")),cn("click",qe,()=>S(u,"rear")),cn("click",zt,()=>E(p(u))),rs(Rn,()=>p(a),w=>S(a,w)),rs(Gi,()=>p(s),w=>S(s,w)),N(e,W),ve()}await Ca();_f(Tv,{target:document.getElementById("app")});
